"use strict";(this.webpackChunk_hz_project_x=this.webpackChunk_hz_project_x||[]).push([[12704],{788624:(e,t,i)=>{i.d(t,{q:()=>f});var s=i(625461);const r=new s.pE("floodgateApiKey",""),o=new s.pE("floodgateClientId","horizon-platform"),n=new s.NE("floodgateFeaturesUrl"),a=new s.NE("floodgateSandbox"),d=new s.pE("floodgateOrgId","9E1005A551ED61CA0A490D45@AdobeOrg"),l=new s.pE("rrEntryName",""),c=new s.pE("rrEntryConfigName",""),h=new s.pE("rrTrafficTargetName",""),u=new s.pE("rrBuildSha",""),_=new s.pE("rrConfigSyncInterval",10),g=new s.pE("consoleLogLevel-AppConfig","info"),f={enabledLogLevelAppConfig:new s.pE("enabledLogLevel-AppConfig","info"),consoleLogLevelAppConfig:g,floodgateApiKey:r,floodgateOrgId:d,floodgateSandbox:a,floodgateClientId:o,floodgateFeaturesUrl:n,rrEntryName:l,rrEntryConfigName:c,rrTrafficTargetName:h,rrBuildSha:u,rrConfigSyncInterval:_,enabledLogLevelFloodgateConnector:new s.pE("enabledLogLevel-FloodgateConnector","info"),consoleLogLevelFloodgateConnector:new s.pE("consoleLogLevel-FloodgateConnector","info"),cdnCacheMaxAge:new s.pE("max-age",3600),cdnCacheSMaxAge:new s.pE("s-maxage",60),cdnCacheStaleWhileRevalidate:new s.pE("stale-while-revalidate",60),cdnCacheStaleIfError:new s.pE("stale-if-error",86400)}},696050:(e,t,i)=>{i.d(t,{q:()=>O});var s=i(625461),r=i(422379);const o=new s.NK("env"),n=new s.NK("envName"),a=new s.NK("ingestApiKey"),d=new s.pE("aaTrackingServer","stats.adobe.com"),l=new s.pE("aaSecureTrackingServer","sstats.adobe.com"),c=new s.pE("bundleHash",""),h=new s.pE("ingestAppCategory","WEB"),u=new s.NK("appVersion"),_=new s.NK("appSAPCode"),g=new s.NK("ingestProject"),f=new s.NE("ingestHost"),p=new s.NE("ingestHostAlwaysProd"),m=new r.L0("ingest-host-always-prod-enabled",!1),w=new s.pE("ingestProcessingInterval",3e3),E=new s.pE("analyticsBufferLimit",500),v=new r.L0("use-experience-edge",!1),S=new r.L0("enable-aep-analytics",!1),b=new r.L0("use-subscription-profile",!1),y=new r.L0("enableAnalytics",!0),A=new s.NE("launchUrl"),C=new s.NE("marketingTechUrl"),O={env:o,envName:n,enableAnalytics:y,ingestAPIKey:a,ingestAppCategory:h,appVersion:u,appSAPCode:_,ingestProject:g,ingestHost:f,ingestHostAlwaysProd:p,ingestHostAlwaysProdEnabled:m,aaTrackingServer:d,aaSecureTrackingServer:l,bundleHash:c,ingestProcessingInterval:w,analyticsBufferLimit:E,aepConfigId:new s.NE("experience-edge-config-id","2a892ed7-c50f-4acf-8726-d41bd770ddbd",{prod:"28baacdc-56e1-4191-a72d-2b4086448495"}),useExperienceEdge:v,enableAEPAnalytics:S,useSubscriptionProfile:b,includeIngestBuildPrefix:new r.L0("include-ingest-build-prefix",!0),otDomainId:new s.NE("otDomainId"),privacyURL:new s.NE("privacyUrl"),footerLinkSelector:new s.pE("footerLinkSelector",""),ingestWaitForAppStartup:new r.L0("ingest-wait-for-app-startup",!0),sendPreConsentEvent:new r.L0("send-pre-consent-event",!0),launchURL:A,marketingTechURL:C,subscriptionProfileAPIKey:new s.pE("subscriptionProfileAPIKey","projectx_webapp"),subscriptionProfileHost:new s.NE("subscriptionProfileHost"),subscriptionProfileEndpoint:new s.pE("subscriptionProfileEndpoint","/abp_profile/v1")}},220963:(e,t,i)=>{i.d(t,{I1:()=>s});var s=function(e){return e.EXPERIMENTAL="experiments-resolution",e.BASELINE="baseline-resolution",e}({})},830925:(e,t,i)=>{i.d(t,{b:()=>s});var s=function(e){return e.local="local",e.dev="dev",e.stage="stage",e.prod="prod",e}(s||{})},548024:(e,t,i)=>{i.d(t,{C:()=>s});var s=function(e){return e.latest="latest",e.nonCurrent="non-current",e.rolledBack="rolled-back",e.expired="expired",e.invalidated="invalidated",e.unknown="unknown",e}({})},298092:(e,t,i)=>{i.d(t,{L:()=>n,VP:()=>s,w$:()=>o,wC:()=>r});const s="feature-enable",r="feature-disable",o="feature-reset",n="setting-"},939417:(e,t,i)=>{i.d(t,{w:()=>n});var s=i(689858),r=i(350595),o=i(422379);let n=class{getFeatureFlagInformation(e){const t=[{source:this.experimentFeatureOverrides,valueSource:o.dD.experiment},{source:this.rolloutFeatureOverrides,valueSource:o.dD.rollout},{source:this._localConfig.features,valueSource:o.dD.browserFlags},{source:this.featureOverrides,valueSource:o.dD.override},{source:this._compiledAppConfig.floodgateFeatureNames,valueSource:o.dD.floodgate},{source:this._compiledAppConfig.featureValues,valueSource:o.dD.code}];for(const{source:i,valueSource:s}of t)if(void 0!==i[e])return{name:e,valueSource:s}}getInformationForAllFeatureFlags(){const e={};return Object.keys(this._compiledAppConfig.featureValues).forEach((t=>{e[t]={name:t,valueSource:o.dD.code}})),Object.keys(this.experimentFeatureOverrides).forEach((t=>{e[t]={name:t,valueSource:o.dD.experiment}})),Object.keys(this.rolloutFeatureOverrides).forEach((t=>{e[t]={name:t,valueSource:o.dD.rollout}})),Object.keys(this._localConfig.features).forEach((t=>{e[t]={name:t,valueSource:o.dD.browserFlags}})),Object.keys(this.featureOverrides).forEach((t=>{e[t]={name:t,valueSource:o.dD.override}})),Object.keys(this._compiledAppConfig.floodgateFeatureNames).forEach((t=>{e[t]={name:t,valueSource:o.dD.floodgate}})),e}setStaticSettings(e){for(const t of Object.keys(e))this.settingOverrides[t]=e[t];this.initResolveSettingOverrides(this.settingOverrides)}setStaticFeatureFlags(e){for(const t of Object.keys(e))this.featureOverrides[t]=e[t];this.initResolveFeatureOverrides(this.featureOverrides)}initializeWithDataTransfer(e,t){this.sessionId=t.sessionId,t.ENABLED_DRAFT_FEATURE_FLAGS&&t.ENABLED_DRAFT_FEATURE_FLAGS.forEach((e=>{r.Vd.has(e)||r.Vd.add(e)})),this.initialize(t.buildInfo,e,t.compiledConfig,t.releasePlaneConfig,t.localConfig,t.featuresFromExperiments||{},void 0,t.featuresFromRollouts||{},!1,void 0)}setLoggerFactory(e){e().then((e=>{this.loggerInstance=e,this.categoryLoggerInstance=e.get("AppConfig")})).catch(console.error)}logger(){return this.loggerInstance}categoryLogger(){return this.categoryLoggerInstance}tryToLogFeatureFlag(e,t,i){this.categoryLoggerInstance?.trace("[AppConfig] Feature flag evaluated",{feature_flag:{key:e,provider_name:t,value:i}})}_notifyFeatureFlagListeners(e,t){t&&t.forEach((t=>t(e)))}constructor(){this.featureOverrides={},this.settingOverrides={},this.experimentFeatureOverrides={},this.rolloutFeatureOverrides={},this._featuresFromExperiments={},this._featuresFromRollouts={},this._isExperimentationEnabled=!1,this._isPersonalizationEnabled=!1,this._localConfig={features:{},settings:{}},this.sessionId=(0,s.Z)(),this._initialized=!1,this.initPromiseSettingOverrides=new Promise((e=>{this.initResolveSettingOverrides=e})),this.initPromiseFeatureOverrides=new Promise((e=>{this.initResolveFeatureOverrides=e})),this.initPromiseExperimentFeatureOverrides=new Promise((e=>{this.initResolveExperimentFeatureOverrides=e})),this.initPromiseRolloutFeatureOverrides=new Promise((e=>{this.initResolveRolloutFeatureOverrides=e}))}}},332805:(e,t,i)=>{i.d(t,{y:()=>v});var s=i(220963),r=i(830925),o=i(350595),n=i(548024),a=i(939417),d=i(298092);const l="_hz_browser_flags",c="_hz_browser_settings";class h{get localConfig(){return{features:{...this._localFeatures,...this._sessionFeatures},settings:{...this._localSettings,...this._sessionSettings}}}_extractFlagsAndSessionSettingsFromURLParams(e){try{e.has(d.w$)&&(this._sessionFeatures={},this._sessionStorage?.removeItem(l)),this._setFeaturesFromUrlParam(e,d.VP,!0),this._setFeaturesFromUrlParam(e,d.wC,!1);const t={};e.forEach(((e,i)=>{if(i.startsWith(d.L)){const s=i.substring(d.L.length),r=t[s];void 0===r||Array.isArray(r)?Array.isArray(r)?r.push(e):t[s]=this._parseSettingParam(e):t[s]=[String(r),e]}})),Object.keys(t).forEach((e=>{this._sessionSettings[e]=t[e]}))}catch(e){console.warn("AppConfig","BrowserLocalConfig","error extracting feature flags and/or session settings overrides from URL params",e)}}_setFeaturesFromUrlParam(e,t,i){for(const s of e.getAll(t)){const e=s.split(",");for(const t of e){const e=t.trim();e&&(this._sessionFeatures[e]=i)}}}_parseSettingParam(e){const t=e.toLowerCase();return"true"===t||"false"!==t&&(isNaN(Number(e))?e:Number(e))}persistURLConfigToSessionStorage(){try{this._sessionStorage?.setItem(l,JSON.stringify(this._sessionFeatures)),this._sessionStorage?.setItem(c,JSON.stringify(this._sessionSettings))}catch(e){console.warn("AppConfig","BrowserLocalConfig","error persisting session config to session storage",e)}}clearSessionStorage(){try{this._sessionFeatures={},this._sessionSettings={},this._sessionStorage?.removeItem(l),this._sessionStorage?.removeItem(c)}catch(e){console.warn("AppConfig","BrowserLocalConfig","error clearing session storage",e)}}clearLocalStorage(){try{this._localFeatures={},this._localSettings={},this._localStorage?.removeItem(l),this._localStorage?.removeItem(c)}catch(e){console.warn("AppConfig","BrowserLocalConfig","error clearing local storage",e)}}clear(){this.clearSessionStorage(),this.clearLocalStorage()}setFeature(e,t,i){this.setFeatures({[e]:t},i)}setFeaturesToValue(e,t,i){const s={};e.forEach((e=>{s[e]=t})),this.setFeatures(s,i)}setFeatures(e,t){try{const i="session"===t?this._sessionFeatures:this._localFeatures;Object.assign(i,e);const s="session"===t?this._sessionStorage:this._localStorage;if(!s)return void console.warn("AppConfig","BrowserLocalConfig",`${t} storage is required to use setFeatures. in-memory setting only`);s.setItem(l,JSON.stringify(i))}catch(e){console.warn("AppConfig","BrowserLocalConfig",`error setting features in ${t} storage. in-memory setting only`,e)}}setSetting(e,t,i="session"){this.setSettings({[e]:t},i)}setSettings(e,t="session"){try{const i="session"===t?this._sessionSettings:this._localSettings;Object.assign(i,e);const s="session"===t?this._sessionStorage:this._localStorage;if(!s)return void console.warn("AppConfig","BrowserLocalConfig",`${t} storage is required to use setSettings. in-memory setting only`);s.setItem(c,JSON.stringify(i))}catch(e){console.warn("AppConfig","BrowserLocalConfig",`error setting settings in ${t} storage. in-memory setting only`,e)}}removeSettings(e,t="session"){try{const i="session"===t?this._sessionSettings:this._localSettings;e.forEach((e=>{delete i[e]}));const s="session"===t?this._sessionStorage:this._localStorage;if(!s)return void console.warn("AppConfig","BrowserLocalConfig",`${t} storage is required to use removeSettings. in-memory removing only`);s.setItem(c,JSON.stringify(i))}catch(e){console.warn("AppConfig","BrowserLocalConfig",`error removing settings in ${t} storage`,e)}}get _localStorage(){try{return window.localStorage}catch(e){return}}get _sessionStorage(){try{return window.sessionStorage}catch(e){return}}_loadFromBrowserStorage(){this._localFeatures=this._loadFeaturesFromStorage("local"),this._localSettings=this._loadSettingsFromStorage("local"),this._sessionFeatures=this._loadFeaturesFromStorage("session"),this._sessionSettings=this._loadSettingsFromStorage("session");const e=this.localConfig;for(const t of Object.keys(e.features)){const i=this._sessionFeatures[t]?"session":"local";console.info("AppConfig","BrowserLocalConfig",`feature[${t}] = ${e.features[t]} (${i} storage)`)}for(const t of Object.keys(e.settings)){const i=this._sessionSettings[t]?"session":"local";console.info("AppConfig","BrowserLocalConfig",`setting[${t}] = ${e.settings[t]} (${i} storage)`)}}_loadFeaturesFromStorage(e){try{const t="session"===e?this._sessionStorage:this._localStorage;if(!t)return console.warn("AppConfig","BrowserLocalConfig",`${e} storage not available. Cannot load features`),{};const i=t.getItem(l);return i?JSON.parse(i):{}}catch(t){return console.warn("AppConfig","BrowserLocalConfig",`error loading features from ${e} storage`,t),{}}}_loadSettingsFromStorage(e){try{const t="session"===e?this._sessionStorage:this._localStorage;if(!t)return console.warn("AppConfig","BrowserLocalConfig",`${e} storage not available. Cannot load settings`),{};const i=t.getItem(c);return i?JSON.parse(i):{}}catch(t){return console.warn("AppConfig","BrowserLocalConfig",`error loading settings from ${e} storage`,t),{}}}constructor(e=new URLSearchParams(window.location.search)){this._localFeatures={},this._localSettings={},this._sessionFeatures={},this._sessionSettings={},this._loadFromBrowserStorage(),this._extractFlagsAndSessionSettingsFromURLParams(e)}}var u=i(788624),_=i(10985),g=i(714684),f=i(868964),p=i(372899);class m{async ping(){return Promise.resolve("OK")}async getConfiguration(){const e=["/_rr_",this._rrEntryName,this._rrEntryConfigName,this._rrTrafficTargetName,this._bundleHash].join("/"),t=(0,p.XD)(this._callRrApi.bind(this),{maxAttempts:m.MAX_RETRIES,delay:m.RETRY_DELAY});return Promise.race([t(e),new Promise(((e,t)=>setTimeout(t,m.TIMEOUT,"Timeout")))])}async _callRrApi(e){try{const t=await this._host.fetch(e);return await t.json()}catch(e){throw console.error(`Failed to get configuration from Request Router service. ${e}`),e}}constructor(e){this._host=e.host,this._bundleHash=e.bundleHash,this._rrEntryName=e.rrEntryName,this._rrEntryConfigName=e.rrEntryConfigName,this._rrTrafficTargetName=e.rrTrafficTargetName}}m.MAX_RETRIES=3,m.RETRY_DELAY=200,m.TIMEOUT=3e3;class w{static isConfigured(){return""!==u.q.rrEntryName.value&&""!==u.q.rrEntryConfigName.value&&""!==u.q.rrTrafficTargetName.value&&""!==u.q.rrBuildSha.value}async getDynamicConfig(){return await this._initializedPromise,this._rrsDynamicConfig}initAndScheduleSyncIfNeeded(){w.isConfigured()?setTimeout((async()=>{await this._setConfiguration(),this._initializedPromiseResolver(),this._scheduleDynamicConfigSync()}),7e4):this._initializedPromiseResolver()}async getBuildState(e){return await this._initializedPromise,this.getBuildStateSync(e)}getBuildStateSync(e){return void 0===this._rrsDynamicConfig||void 0===this._rrsDynamicConfig.builds||void 0===this._rrsDynamicConfig.builds[e]?n.C.unknown:this._rrsDynamicConfig.builds[e].state}addBuildStateObserver(e,t){this._buildStateObservers.set(e,t),this._rrsDynamicConfig&&this._rrsDynamicConfig.builds[e]&&t(this._rrsDynamicConfig.builds[e].state)}_scheduleDynamicConfigSync(){setInterval(this._setConfiguration,60*u.q.rrConfigSyncInterval.value*1e3)}constructor(e){if(this._buildStateObservers=new Map,this._setConfiguration=async()=>{try{const e=this._rrsDynamicConfig;this._rrsDynamicConfig=await this._rrApiClient.getConfiguration();for(const[t,i]of this._buildStateObservers.entries()){const s=this._rrsDynamicConfig?.builds[t]?.state;e?.builds[t]?.state!==s&&i(s)}}catch(e){console.error("AppConfig","RrsDynamicConfig","Error while syncing dynamic config",e)}},this._initializedPromise=new Promise((e=>{this._initializedPromiseResolver=e})),!w.isConfigured())return console.info("AppConfig","RrsDynamicConfig","At least one of the required settings is missing. Skipping heartbeat initialization."),void this._initializedPromiseResolver();this._host=e,this._rrApiClient=new m({rrEntryName:u.q.rrEntryName.value,rrEntryConfigName:u.q.rrEntryConfigName.value,rrTrafficTargetName:u.q.rrTrafficTargetName.value,bundleHash:u.q.rrBuildSha.value,host:this._host})}}var E=i(229565);let v=class e extends a.w{static singleton(){return e._singleton||(e._singleton=new e),e._singleton}static async createInitializeAttach(t,i,s,r,o,n,a,d,l){const c=new e;return await c.initialize(t,i,s,r,o,a,d,l),n&&c.attach(n),c}createModuleConfig(){return new f.M(this)}registerListener(e,t){void 0===this._updateListeners[e]?this._updateListeners[e]=[t]:this._updateListeners[e]=[...this._updateListeners[e],t]}isPendingExperimentResolution(e){return void 0!==this._pendingExperimentsFeatureFlags[e]}isPendingRolloutResolution(e){return void 0!==this._pendingRolloutConfigurationsFeatureFlags[e]}async getFeaturesFromExperiments(){return await this.initialized(),this._featuresFromExperiments}async getFeaturesOverrides(){await Promise.allSettled([this.initialized(),this._experimentsInitialized(),this._rolloutConfigurationsInitialized()]);const e={},t=g.Y.getInstance(this);for(const i in this._compiledAppConfig.floodgateFeatureNames)e[i]=await t.getFeatureState(i);return{...e,...this.featureOverrides,...this.rolloutFeatureOverrides,...this.experimentFeatureOverrides}}getBrowserLocalConfig(){return this._browserLocalConfig}_getEnvValue(e){if(void 0!==e){if(!this._initializedEnv){const e="Checking environmental config can only be done after appConfig.initialized()";throw console.error("AppConfig",e),new Error(e)}return void 0!==e.envOverrides[this._initializedEnv]?e.envOverrides[this._initializedEnv]:e.default}}_getSettingValue(e){let t;if(!this._initialized)throw t="Checking setting config can only be done after appConfig.initialize(..)",console.error("AppConfig",t),new Error(t);const i=this._localConfig.settings[e];if(void 0!==i)return i;if(void 0!==this.settingOverrides[e])return this.settingOverrides[e];const s=this._getEnvValue(this._compiledAppConfig.envSettings[e]);if(void 0!==s)return s;const r=this._compiledAppConfig.settingValues[e];if(void 0!==r)return r;throw new Error("Static config not found: "+e)}_setSettingValue(e,t){if(void 0!==this._lazySettings?.get(e)&&this._lazySettings.delete(e),this.settingOverrides[e]=t,void 0!==this._lazySettings?.get(e)&&this._lazySettings.delete(e),this._requiredSettingsResolvers.has(e)){this._requiredSettingsResolvers.get(e)(t),this._requiredSettingsResolvers.delete(e)}}_getBrowserFlag(e){return this._localConfig.features[e]}_getBrowserSetting(e){return this._localConfig.settings[e]}async getLocalConfig(){return await this.initialized(),this._localConfig}setLocalConfig(e){this._localConfig=e}getFeatureOverrideValue(e){return"boolean"==typeof this.featureOverrides[e]?this.featureOverrides[e]:void 0}getFeatureValueFromExperiments(e){return"boolean"==typeof this.experimentFeatureOverrides[e]?this.experimentFeatureOverrides[e]:void 0}getFeatureValueFromRolloutConfigurations(e){return"boolean"==typeof this.rolloutFeatureOverrides[e]?this.rolloutFeatureOverrides[e]:void 0}_getFeatureEnabled(e,t){if(!this._initialized){const e="Checking feature config can only be done after appConfig.initialize(..)";throw console.error("AppConfig",e),new Error(e)}if("boolean"==typeof this._localConfig.features[e])return this.tryToLogFeatureFlag(e,E.R.browserFlags,this._localConfig.features[e]),this._localConfig.features[e];const i=this.getFeatureValueFromExperiments(e);if(void 0!==i)return this.tryToLogFeatureFlag(e,E.R.expClient,i),i;if("boolean"==typeof this.rolloutFeatureOverrides[e])return this.tryToLogFeatureFlag(e,E.R.rollout,this.rolloutFeatureOverrides[e]),this.rolloutFeatureOverrides[e];if("boolean"==typeof this.featureOverrides[e])return this.tryToLogFeatureFlag(e,E.R.releasePlane,this.featureOverrides[e]),this.featureOverrides[e];const s=t();return"boolean"==typeof s?(this.tryToLogFeatureFlag(e,E.R.floodgate,s),s):(this.tryToLogFeatureFlag(e,E.R.appConfig,Boolean(this._compiledAppConfig.featureValues[e])),Boolean(this._compiledAppConfig.featureValues[e]))}async initialize(e,t,i,s,r,o,n,a,d=!0,l){this._initialized?console.warn("AppConfig","AppConfig is already initialized, not doing anything"):(this.attach(u.q),this.buildInfo=e,this._host=t,void 0!==r?this._localConfig=r:this._host.sessionStorage()&&(this._browserLocalConfig=this._createBrowserLocalConfig(this._host.searchParams()??new URLSearchParams),this._localConfig=this._browserLocalConfig.localConfig),this._isExperimentationEnabled=this._localConfig.features["enable-experimentation"]||s.features["enable-experimentation"],this._isPersonalizationEnabled=this._localConfig.features["enable-personalization"]||s.features["enable-personalization"],this._compiledAppConfig=i,this._featuresFromExperiments=o||{},this._featuresFromRollouts=a||{},this._isPersonalizationEnabled&&(this._pendingRolloutConfigurationsFeatureFlags={...a}),0===Object.keys(this._featuresFromRollouts).length&&this.initResolveRolloutFeatureOverrides(),0===Object.keys(this._featuresFromExperiments).length&&this.initResolveExperimentFeatureOverrides(),void 0!==s.features["appconfig-wait-for-experiments"]&&(this._waitForExperimentsAndRollouts=s.features["appconfig-wait-for-experiments"]),0===Object.keys(this._featuresFromExperiments).length&&0===Object.keys(this._featuresFromRollouts).length&&(this._waitForExperimentsAndRollouts=!1),this._setStaticFeatureOverrides(s.features),this._configureExperimentsFeatureFlags(s,n),this._configureRolloutsFeatureFlags(l),i.lazySettings.length>0&&(this._lazySettings=new Map,i.lazySettings.forEach((e=>{this._lazySettings.set(e,e)}))),this._setStaticSettingOverrides(s.settings),await this.initialized(),d&&this._scheduleDynamicConfigSync())}isLazySetting(e){return void 0!==this._lazySettings?.get(e)}_createBrowserLocalConfig(e){return new h(e)}_isExperimentsFeatureFlagResolutionEnabled(e){return void 0!==e.settings["experiments-feature-flag-strategy"]?e.settings["experiments-feature-flag-strategy"]!==s.I1.BASELINE:"string"!=typeof e.settings.env||e.settings.env!==r.b.stage}_configureExperimentsFeatureFlags(e,t){if(this._isExperimentationEnabled&&(this._pendingExperimentsFeatureFlags={...this._featuresFromExperiments},t)){const i=this._isExperimentsFeatureFlagResolutionEnabled(e)?t():{};this.experimentFeatureOverrides={...this.experimentFeatureOverrides,...i}}}_configureRolloutsFeatureFlags(e){if(this._isPersonalizationEnabled&&e){const t=e();this.rolloutFeatureOverrides={...this.rolloutFeatureOverrides,...t}}}_scheduleDynamicConfigSync(){w.isConfigured()&&(this._rrsDynamicConfig=new w(this._host),this._rrsDynamicConfig.initAndScheduleSyncIfNeeded())}async initialized(){this._initialized||(await Promise.all([this.initPromiseFeatureOverrides,this.initPromiseSettingOverrides]),this._initialized=!0)}updateFeaturesFromExperiments(e,t=!0){for(const i of Object.keys(e))void 0!==this._featuresFromExperiments[i]&&(t&&(this.experimentFeatureOverrides[i]=e[i]),this._notifyFeatureFlagListeners(i,this._updateListeners[i]),delete this._pendingExperimentsFeatureFlags[i]);0===Object.keys(this._pendingExperimentsFeatureFlags).length&&this.initResolveExperimentFeatureOverrides()}updateRolloutFeatures(e,t=!0){for(const i of Object.keys(e))void 0!==this._pendingRolloutConfigurationsFeatureFlags[i]&&(t&&(this.rolloutFeatureOverrides[i]=e[i]),this._notifyFeatureFlagListeners(i,this._updateListeners[i]),delete this._pendingRolloutConfigurationsFeatureFlags[i]);0===Object.keys(this._pendingRolloutConfigurationsFeatureFlags).length&&this.initResolveRolloutFeatureOverrides()}resolvePendingRolloutFeatureFlags(){for(const e in this._pendingRolloutConfigurationsFeatureFlags)void 0!==this._pendingRolloutConfigurationsFeatureFlags[e]&&delete this.rolloutFeatureOverrides[e],delete this.rolloutFeatureOverrides[e],this._notifyFeatureFlagListeners(e,this._updateListeners[e]),delete this._pendingRolloutConfigurationsFeatureFlags[e];this.initResolveRolloutFeatureOverrides()}resolvePendingExperimentFeatureFlags(){for(const e in this._pendingExperimentsFeatureFlags)void 0!==this._pendingExperimentsFeatureFlags[e]&&delete this.experimentFeatureOverrides[e],this._notifyFeatureFlagListeners(e,this._updateListeners[e]),delete this._pendingExperimentsFeatureFlags[e];this.initResolveExperimentFeatureOverrides()}whichEnginesEnabled(){const e={experimentation:!1,personalization:!1};return this._waitForExperimentsAndRollouts&&(e.experimentation=this._isExperimentationEnabled,e.personalization=this._isPersonalizationEnabled),e}_experimentsInitialized(){return this.initPromiseExperimentFeatureOverrides}_rolloutConfigurationsInitialized(){return this.initPromiseRolloutFeatureOverrides}async getHost(){return this.initPromiseSettingOverrides.then((()=>this._host))}async getEnabledFeaturesFromFloodgate(e){return void 0===this._floodgateConnector&&(this._floodgateConnector=new _.L(this)),this._floodgateConnector.getEnabledFeatures(e)}async syncWithFloodgate(){return await this.initialized(),g.Y.getInstance(this).syncNow()}setFactoryForAccessTokenProvider(e){this._atpFactoryResolver(e)}async getAccessTokenProvider(){return(await this._atpFactoryPromise)()}async attach(e){const t=e;if(t[this._attachMarker])return this.initialized();t[this._attachMarker]=!0;for(const t of Object.keys(e))e[t].attach(this);return this.initialized()}setUrlParams(e){this._urlParams=e}getUrlParams(){return this._urlParams}maybeRegisterSettingResolver(e,t){return void 0!==this._lazySettings?.get(e)&&(this._requiredSettingsResolvers.set(e,t),!0)}get _environment(){if(!this._initializedEnv){const e="appConfig._environment can only be checked synchronously after awaiting appConfig.initialize()";throw console.error("AppConfig",e),new Error(e)}return this._initializedEnv}_setStaticSettingOverrides(e){let t,i;if("string"!=typeof e.env)throw i="Invalid AppConfig settings override does not include required 'env'.",console.error("AppConfig",i),new Error(i);if(t=e.env,!Object.keys(r.b).includes(t))throw i=`Invalid AppConfig settings override.  Unsupported 'env' value provided = ${t}`,console.error("AppConfig",i),new Error(i);if(this._initializedEnv=t,"string"!=typeof e.envName)throw i="Invalid AppConfig settings override does not include required 'envName'.",console.error("AppConfig",i),new Error(i);super.setStaticSettings(e)}async getSettings(){await this.initialized();const e={};for(const t of Object.keys(this._compiledAppConfig.settingValues))e[t]=this._compiledAppConfig.settingValues[t];for(const t of Object.keys(this._compiledAppConfig.envSettings)){const i=this._getEnvValue(this._compiledAppConfig.envSettings[t]);void 0!==i&&(e[t]=i)}for(const t of Object.keys(this.settingOverrides))e[t]=this.settingOverrides[t];for(const t of Object.keys(this._localConfig.settings))e[t]=this._localConfig.settings[t];return e}async hasDraftFeature(e){await this.initialized();return this._localConfig.features[e]??o.Vd.has(e)}async getFeatures(e=!0){if(await this.initialized(),!this._cachedFeaturesWithoutDraft){const e={};for(const t of Object.keys(this._compiledAppConfig.featureValues))e[t]=this._compiledAppConfig.featureValues[t];for(const t of Object.keys(this.featureOverrides))e[t]=this.featureOverrides[t];for(const t of Object.keys(this._localConfig.features))e[t]=this._localConfig.features[t];this._cachedFeaturesWithoutDraft=e}if(!1===e)return this._cachedFeaturesWithoutDraft;if(!this._cachedFeaturesWithDraft){const e={...this._cachedFeaturesWithoutDraft};for(const t of this._compiledAppConfig.draftDocModelFeatureNames){e[t]&&!this._localConfig.features[t]&&(e[t]=!1);const i=t;void 0!==i&&o.Vd.has(i)&&(e[t]=!0)}this._cachedFeaturesWithDraft=e}return this._cachedFeaturesWithDraft}async getWorkerDataTransfer(){await this.initialized();const e=await this.getBasicWorkerDataTransfer();return this._waitForExperimentsAndRollouts&&(await Promise.all([this._experimentsInitialized(),this._rolloutConfigurationsInitialized()]),e.releasePlaneConfig.features={...this.featureOverrides,...this.rolloutFeatureOverrides,...this.experimentFeatureOverrides},e.featuresFromExperiments={},e.featuresFromRollouts={}),e}async getBasicWorkerDataTransfer(){return await this.initialized(),{sessionId:this.sessionId,buildInfo:JSON.parse(JSON.stringify(this.buildInfo)),compiledConfig:this._compiledAppConfig,releasePlaneConfig:{settings:this.settingOverrides,features:{...this.featureOverrides,...this.experimentFeatureOverrides,...this.rolloutFeatureOverrides}},featuresFromExperiments:this._featuresFromExperiments,featuresFromRollouts:this._featuresFromRollouts,localConfig:this._localConfig,ENABLED_DRAFT_FEATURE_FLAGS:o.Vd}}_setStaticFeatureOverrides(e){super.setStaticFeatureFlags(e)}async hasFeature(e){const t=await this.getFeatures();return Boolean(t[e])}async _resetBrowserFlags(){this._browserLocalConfig?.clearSessionStorage()}_setBrowserFlag(e,t,i=!1,s=!1){this._browserLocalConfig?.setFeature(e,t,"session"),i&&(this._localConfig=this._browserLocalConfig?.localConfig??this._localConfig),s&&(this._cachedFeaturesWithDraft=void 0,this._cachedFeaturesWithoutDraft=void 0),this.categoryLoggerInstance?.info("Success - flag set locally in this browser.")}_setBrowserFlagList(e,t,i=!1){this._browserLocalConfig?.setFeaturesToValue(e,t,"session"),i&&(this._cachedFeaturesWithDraft=void 0,this._cachedFeaturesWithoutDraft=void 0),this.categoryLoggerInstance?.info("Success - flag set locally in this browser.")}async _setBrowserSetting(e,t){this._browserLocalConfig?.setSetting(e,t,"session"),this.categoryLoggerInstance?.info("Success - setting set locally in this browser.")}setExperimentOverrides(e,t=!1){this.experimentFeatureOverrides={...this.experimentFeatureOverrides,...e},t&&(this._cachedFeaturesWithDraft=void 0,this._cachedFeaturesWithoutDraft=void 0)}setRolloutOverrides(e,t=!1){this.rolloutFeatureOverrides={...this.rolloutFeatureOverrides,...e},t&&(this._cachedFeaturesWithDraft=void 0,this._cachedFeaturesWithoutDraft=void 0)}getFloodgateKeyOrName(e){if(!this._initialized){throw new Error("Checking feature values can only be done after appConfig.initialize(..)")}return this._compiledAppConfig.floodgateFeatureNames[e]??void 0}async getAppDraftModelFlags(){await this.initialized();const e=this._localConfig.features;return Object.values(o._5).filter((t=>e[t]??o.Vd.has(t)))}async adoptDraftModelFlags(e){if(!this._browserLocalConfig)return!1;const t={};for(const i of e)t[i]=!0;const i=await this.getAppDraftModelFlags();for(const s of i)e.includes(s)||(t[s]=!1);return this._browserLocalConfig.setFeatures(t,"session"),!0}async persistAllBrowserFlags(){await this.initialized(),this._browserLocalConfig?.persistURLConfigToSessionStorage()}async getCurrentBuildState(){return await this.initialized(),void 0===this._rrsDynamicConfig?n.C.unknown:this._rrsDynamicConfig.getBuildState(u.q.rrBuildSha.value)}getCurrentBuildStateSync(){return void 0===this._rrsDynamicConfig?n.C.unknown:this._rrsDynamicConfig.getBuildStateSync(u.q.rrBuildSha.value)}addBuildStateObserver(e){this._rrsDynamicConfig?.addBuildStateObserver(u.q.rrBuildSha.value,e)}getOtelServiceName(){return this.getSettingUnsafe("serviceName")}getSettingUnsafe(e){if(this._initialized)try{return this._getSettingValue(e)}catch(e){return}}getExperimentsFeatureOverrides(){return this.experimentFeatureOverrides}async getExperimentsFeatureOverridesAsync(){return await this._experimentsInitialized(),this.getExperimentsFeatureOverrides()}getRolloutFeatureOverrides(){return this.rolloutFeatureOverrides}async getRolloutFeatureOverridesAsync(){return await this._rolloutConfigurationsInitialized(),this.getRolloutFeatureOverrides()}constructor(){super(),this._urlParams=new URLSearchParams,this._requiredSettingsResolvers=new Map,this._pendingExperimentsFeatureFlags={},this._pendingRolloutConfigurationsFeatureFlags={},this._updateListeners={},this._waitForExperimentsAndRollouts=!0,this._browserLocalConfig=void 0,this._cachedFeaturesWithDraft=void 0,this._cachedFeaturesWithoutDraft=void 0,this._atpFactoryPromise=new Promise((e=>{this._atpFactoryResolver=e})),this._attachMarker=Symbol("app-config-attach-marker"),"undefined"!=typeof window&&window&&this.setUrlParams(new URLSearchParams(window.location.search))}}},229565:(e,t,i)=>{i.d(t,{R:()=>s});var s=function(e){return e.appConfig="app_config",e.browserFlags="browser_flags",e.expClient="exp_client",e.floodgate="floodgate",e.moduleConfig="module_config",e.releasePlane="release_plane",e.rollout="rollout",e}({})},10985:(e,t,i)=>{i.d(t,{L:()=>d});var s=i(198194),r=i(372899),o=i(788624),n=i(812683);class a{static markBegin(e){const t=`${e.measureName}:begin`;performance.mark(t)}static markEndAndMeasure(e){const t=`${e.measureName}:end`;return performance.mark(t),performance.measure(e.measureName,a._getMeasureDetail(e))}static _getMeasureDetail(e){const t={start:`${e.measureName}:begin`,end:`${e.measureName}:end`};return t.detail={devtools:{track:e.trackName||a._getTrackName(),dataType:"track-entry",tooltipText:e.tooltipText||e.measureName}},t}static _getTrackName(){if(a._isMainThread())return n.W.UI;const e=a._getThreadName();return e.includes("authoring")?n.W.AUTHORING:e.includes("rendering")||e.includes("renderer")?n.W.RENDERING:(console.warn("No track name found"),n.W.DEFAULT)}static _isMainThread(){return"undefined"!=typeof window&&"undefined"!=typeof self&&self===window}static _getThreadName(){return"undefined"!=typeof self&&self.name?self.name:"undefined"!=typeof globalThis&&globalThis.threadName?globalThis.threadName:(console.warn("No thread name found"),"unknown")}}let d=class{async getEnabledFeatures(e){return await this._initPromise,this._apiKey&&0!==this._apiKey.length?this._getAllEnabledFeatures(e):(this._categoryLogger?.warn("Not calling the Floodgate API because the API key is missing!"),{})}async _init(){this._host=await this._appConfig.getHost(),this._apiKey=o.q.floodgateApiKey.value,this._clientId=o.q.floodgateClientId.value,this._featuresUrl=o.q.floodgateFeaturesUrl.value,this._fgOrgId=o.q.floodgateOrgId.value,this._fgSandbox=o.q.floodgateSandbox.value}async _getAllEnabledFeatures(e){try{const t=await this._callFeaturesApi(e);return this._extractFeaturesFromApiResponse(t)}catch(e){return this._categoryLogger?.warn("Caught error while trying to obtain FloodGate features",e),{}}}_extractFeaturesFromApiResponse(e){if(void 0===e.releases)return{};const t={};return e.releases.forEach((e=>{e.features.forEach((e=>t[e]=!0))})),t}async _callFeaturesApi(e){const t=this._getFeaturesUrl(),i=await this._getRequestHeaders(e),s={measureName:"floodgate-features-api"};a.markBegin(s);const o=performance.now(),n=(0,r.XD)((()=>this._host.fetch(t,{method:"GET",headers:i})),{maxAttempts:3,timeoutInterval:5e3,shouldRetry:e=>e.message.includes("Failed to fetch")}),d=await n();this._recordDuration(performance.now()-o);const l=a.markEndAndMeasure(s);return this._categoryLogger?.debug("Floodgate API call duration: ",l?.duration,"ms"),await d.json()}_recordDuration(e){const t=this._appConfig.getOtelServiceName();t&&(this._histogramMeter||(this._histogramMeter=s.ZP.metrics.getMeter(t).createHistogram("hz_prx_floodgate_api_duration_ms")),this._histogramMeter.record(e))}_getFeaturesUrl(){return`${this._featuresUrl}?clientId=${this._clientId}`}async _getRequestHeaders(e){const t={"x-api-key":this._apiKey,"Content-Type":"application/json","x-gw-ims-org-id":this._fgOrgId,"x-sandbox-name":this._fgSandbox};return void 0!==e&&(t.Authorization=`Bearer ${e}`),t}constructor(e){this._appConfig=e,this._appConfig.attach(o.q),this._categoryLogger=this._appConfig.categoryLogger(),this._initPromise=this._init()}}},714684:(e,t,i)=>{i.d(t,{Y:()=>r});var s=i(10985);class r{static getInstance(e){return void 0===r._instance&&(r._instance=new r(e)),r._instance}_createFloodgateConnector(){return new s.L(this._appConfig)}async syncNow(){return void 0===this._onDemandSyncPromise&&(this._onDemandSyncPromise=new Promise(((e,t)=>{setTimeout((async()=>{try{await this._resyncFeatures(!1),e()}catch(e){t(e)}finally{this._onDemandSyncPromise=void 0}}))}))),this._onDemandSyncPromise}async getFeatureState(e){return(await this._initFloodgatePromise)[e]??!1}registerForUpdates(e,t){if(!0!==e.floodgateData.dynamic)throw new Error(`Cannot register feature "${e.name}" for updates because it is not dynamic.`);this._updateListeners[e.name]=t,this._resyncScheduled||this._scheduleResync()}async _initEnabledFeatures(){const e=await this._getAccessToken(),t=await this._floodgateConnector.getEnabledFeatures(e);this._resolveFloodgateFeatures(t)}async _resyncFeatures(e=!0){const t=await this._getAccessToken();void 0===t&&this._appConfig?.categoryLogger()?.warn("AppConfig: Floodgate API will be called without an access token.");const i=await this._floodgateConnector.getEnabledFeatures(t);for(const e of Object.keys(this._updateListeners)){const t=i[e]??!1;try{this._updateListeners[e](t)}catch(i){this._appConfig?.categoryLogger()?.warn(`An error was caught when trying to update feature "${e}" with state "${t}":`,i)}}e&&this._scheduleResync()}_scheduleResync(){setTimeout((async()=>{this._resyncFeatures()}),r.RESYNC_INTERVAL),this._resyncScheduled=!0}async _getAccessToken(e=5e3){const t=new Promise(((t,i)=>{setTimeout((()=>t(void 0)),e)})),i=await Promise.race([t,this._appConfig.getAccessTokenProvider()]);if(void 0!==i){const e=await i.getAccessTokenValue();if(void 0===e)return e;const t=e.split(".");if(t&&3===t.length)try{const i=atob(t[1]);return"guest"===JSON.parse(i).atp?void 0:e}catch(t){return e}return e}this._appConfig?.categoryLogger()?.warn(`AppConfig: No IMS access token provider received in ${e} ms`)}constructor(e){this._resyncScheduled=!1,this._updateListeners={},this._appConfig=e,this._initFloodgatePromise=new Promise(((e,t)=>{this._resolveFloodgateFeatures=e})),this._floodgateConnector=this._createFloodgateConnector(),this._initEnabledFeatures()}}r.RESYNC_INTERVAL=3e5},375735:(e,t,i)=>{i.d(t,{y:()=>a});var s=i(977871);const r={[s.QY.Edge]:/(?:Edge|Edg(?:A|iOS)?)\/(\d+\.[\d.]+)/,[s.QY.Firefox]:/(?:Firefox|FxiOS)\/(\d+(\.\d+)?)/,[s.QY.Chrome]:/(?:Chrome|CriOS)\/(\d+\.[\d.]+)/,[s.QY.Safari]:/version\/(\d+(\.?_?\d+)+)/i,[s.QY.Samsung]:/(?:SamsungBrowser)\/(\d+\.[\d.]+)/},o={[s.OS.Windows]:/Windows NT (\d+\.\d+)/,[s.OS.Mac]:/Mac OS X (\d+([._]\d+)*)/,[s.OS.iOS]:/OS (\d+([._]\d+)*)/,[s.OS.iPadOS]:/OS (\d+([._]\d+)*)/,[s.OS.Android]:/Android (\d+(\.\d+)*)/,[s.OS.ChromeOS]:/CrOS(?: [a-z0-9-_.]+)? (\d+(\.\d+)*)/},n=/Version\/(\d+([._]\d+)*)/;class a{get deviceOs(){return this._deviceOs??(this._deviceOs=this._getDeviceOS())}get deviceModel(){return this._deviceModel??(this._deviceModel=this._getDeviceModel())}get deviceOsVersion(){return this._deviceOsVersion??(this._deviceOsVersion=this._getDeviceOSVersion())}async deviceOsVersionNumber(){return(await(this._navigator.userAgentData?.getHighEntropyValues?.(["platformVersion"])))?.platformVersion||this.deviceOsVersion}get webBrowser(){return this._webBrowser??(this._webBrowser=this._getWebBrowser())}get webBrowserVersion(){return this._webBrowserVersion??(this._webBrowserVersion=this._getWebBrowserVersion())}get platformIsMacLike(){return this.deviceOs===s.OS.Mac||this.deviceOs===s.OS.iOS}get isMacDevice(){return this.deviceOs===s.OS.Mac}get isAndroidDevice(){return this.deviceOs===s.OS.Android}get isLinuxDevice(){return this.deviceOs===s.OS.Linux}get isIOSDevice(){return this.deviceOs===s.OS.iOS}get isIPadOSDevice(){return this.deviceOs===s.OS.iPadOS}get isChromeOSDevice(){return this.deviceOs===s.OS.ChromeOS}get isMobile(){return this.isIOSDevice||this.isAndroidDevice}get isChromeBrowser(){return this.webBrowser===s.QY.Chrome}get isFirefoxBrowser(){return this.webBrowser===s.QY.Firefox}get isEdgeBrowser(){return this.webBrowser===s.QY.Edge}get isSafariBrowser(){return this.webBrowser===s.QY.Safari}get isSamsungBrowser(){return this.webBrowser===s.QY.Samsung}get isWebKitBrowser(){return this.webBrowser===s.QY.Safari||this.webBrowser===s.QY.WebKitBased}get isMobileWeb(){return this.isMobile&&!this.isMobileWebView}get isMsftPWA(){return this._getMsftPWA()}get isNonMsftPWA(){return this._getNonMsftPWA()}get isDesktopShellApp(){return this._getDesktopShellApp()}get PWAInstallationSource(){return this._getWithinExpressPWAInstallation()?"within-express":this.isMsftPWA?"msstore":this.isNonMsftPWA?"browser":"NA"}isWindowAvailable(){return"undefined"!=typeof window&&void 0!==window.location}get isEmbed(){if(!this.isWindowAvailable())return!1;return"true"===new URL(window.location.href).searchParams.get("embed")}get isEmbedVideo(){if(!this.isWindowAvailable())return!1;return"true"===new URL(window.location.href).searchParams.get("embedVideo")}get isEmbedDesktop(){if(!this.isEmbed)return!1;return"desktop"===new URL(window.location.href).searchParams.get("platform")}get isEmbedWeb(){if(!this.isEmbed)return!1;return"web"===new URL(window.location.href).searchParams.get("platform")}get isMobileWebView(){return this.webBrowser===s.QY.WebView}get isIOSApp(){return this.isIOSDevice&&Boolean(this._window?.webkit?.messageHandlers?.hzMobile?.postMessage)}get isIPadApp(){return this.isIPadOSDevice&&Boolean(this._window?.webkit?.messageHandlers?.hzMobile?.postMessage)}get isAndroidApp(){return Boolean(this._window?.hzMobile?.postMessage)}get isChromeOSWeb(){return this.isChromeOSDevice&&!this.isAndroidApp}get isEmbedIosWebView(){return this.isEmbed&&Boolean(window?.webkit?.messageHandlers?.IOSBridge?.postMessage)}get isEmbedAndroidWebView(){return this.isEmbed&&Boolean(window?.AndroidBridge?.receiveMessage)}get isEmbedMobileWebView(){return this.isEmbedAndroidWebView||this.isEmbedIosWebView}get maxTouchPoints(){return this._navigator.maxTouchPoints}get _window(){return"undefined"!=typeof window?window:void 0}async isBraveBrowser(){const e=this._navigator;return void 0===this._isBraveBrowser&&(this._isBraveBrowser=await(e.brave?.isBrave?.())??!1),this._isBraveBrowser}_getDeviceOS(){const e=this._navigator?.userAgent??"",t=this._navigator?.maxTouchPoints??0;return/\bwindows nt\b/i.test(e)?s.OS.Windows:/\bMacintosh\b/.test(e)?t>0?s.OS.iPadOS:s.OS.Mac:/\biPad\b/.test(e)?s.OS.iPadOS:/\biPhone|iPod\b/.test(e)?s.OS.iOS:/\bAndroid\b/.test(e)?s.OS.Android:/\bCrOS\b/.test(e)?s.OS.ChromeOS:/\bLinux\b/.test(e)?s.OS.Linux:s.OS.Unknown}_getDeviceOSVersion(){const e=this._navigator?.userAgent??"",t=/\bMacintosh\b/.test(e),i=this._navigator?.maxTouchPoints>0;let s;if(s=t&&i?n:o[this.deviceOs],s){const e=this._navigator.userAgent.match(s);if(Array.isArray(e)&&"string"==typeof e[1])return e[1].replace(/_/g,".")}return""}_getWebBrowser(){const e=this._navigator?.userAgent;return this.isAndroidApp||this.isIOSApp||this.isIPadApp?s.QY.WebView:/SamsungBrowser/.test(e)?s.QY.Samsung:/Chrome|CriOS/.test(e)&&!/Edg|OPR|Opera|OPiOS|Vivaldi|YaBrowser|Avast|VivoBrowser|GSA/.test(e)?s.QY.Chrome:/Firefox|FxiOS/.test(e)?s.QY.Firefox:/Edg[eA]?/.test(e)?s.QY.Edge:/Safari/.test(e)&&!/Chrome|CriOS|FxiOS|Edg|OPR|Opera|OPiOS|Vivaldi|YaBrowser|Avast|VivoBrowser|GSA/.test(e)?s.QY.Safari:/AppleWebKit/i.test(e)&&!/Edg|OPR|Opera|OPiOS|Vivaldi|YaBrowser|Avast|VivoBrowser|GSA/.test(e)?s.QY.WebKitBased:s.QY.Unknown}_getWebBrowserVersion(){const e=r[this.webBrowser];if(e){const t=this._navigator.userAgent.match(e);if(Array.isArray(t)&&t.length>=2&&"string"==typeof t[1])return t[1]}return""}_parseModelFromUserAgent(e){const t=e.match(/iPhone(\d+,\d+)/);if(t)return`iPhone ${t[1]}`;const i=e.match(/iPad(\d+,\d+)/);if(i)return`iPad ${i[1]}`;const s=e.match(/SM-[A-Z]\d{3,4}[A-Z]?/);if(s)return s[0];const r=e.match(/Pixel (\d+)(?: XL| Pro)?/i);if(r)return r[0];const o=e.match(/;\s*([^;)]+(?:(?!Build\/)\S)*)/);if(o)return o[1].trim();const n=e.match(/\(([^)]+)\)/);return n?n[1].trim():e}async _getDeviceModel(){return(await(this._navigator.userAgentData?.getHighEntropyValues?.(["model"])))?.model??this._parseModelFromUserAgent(this._navigator?.userAgent)}_isRunningInPWAMode(){const e=new URL(document.location.href);return Boolean(e.searchParams.get("running_pwa_mode"))}detectAndSetPWAStatusInStorage(){const e=sessionStorage;e&&("app-info://platform/microsoft-store"===document.referrer?e.setItem("msftPWA","true"):!e.getItem("msftPWA")&&(window.matchMedia("(display-mode: standalone)").matches||window.matchMedia("(display-mode: minimal-ui)").matches||this._isRunningInPWAMode())&&e.setItem("otherPWA","true"))}_getMsftPWA(){return!!sessionStorage&&(this.detectAndSetPWAStatusInStorage(),Boolean(sessionStorage.getItem("msftPWA")))}_getNonMsftPWA(){return!!sessionStorage&&(this.detectAndSetPWAStatusInStorage(),Boolean(sessionStorage.getItem("otherPWA")))}_getDesktopShellApp(){return"shell-app"===this._getLocalStorageItem("externalAppType")}_getWithinExpressPWAInstallation(){return!!localStorage&&(this.detectAndSetPWAStatusInStorage(),"true"===this._getLocalStorageItem("withinExpressPWAInstall"))}_getLocalStorageItem(e){try{return localStorage?.getItem(e)||null}catch(e){return null}}async hasStorageAccessPermission(){if(!document.hasStorageAccess)return!0;if(await document.hasStorageAccess())return!0;try{return"granted"===(await navigator.permissions.query({name:"storage-access"})).state&&(document.requestStorageAccess&&await document.requestStorageAccess(),!0)}catch(e){return!0}}constructor(e){this._navigator=e}}},430871:(e,t,i)=>{i.d(t,{qD:()=>o});var s=i(375735),r=i(977871);class o extends EventTarget{get deviceOs(){return this.browserOSUtils.deviceOs}get deviceModel(){return this.browserOSUtils.deviceModel}get deviceOsVersion(){return this.browserOSUtils.deviceOsVersion}get webBrowser(){return this.browserOSUtils.webBrowser}get platformIsMacLike(){return this.browserOSUtils.platformIsMacLike}get isMacDevice(){return this.browserOSUtils.isMacDevice}get isAndroidDevice(){return this.browserOSUtils.isAndroidDevice}get isLinuxDevice(){return this.browserOSUtils.isLinuxDevice}get isDesktopShellApp(){return this.browserOSUtils.isDesktopShellApp}get isIOSDevice(){return this.browserOSUtils.isIOSDevice}get isIPadOSDevice(){return this.browserOSUtils.isIPadOSDevice}get webBrowserVersion(){return this.browserOSUtils.webBrowserVersion}get webBrowserInfo(){return{browser:this.webBrowser,version:this.webBrowserVersion}}get isChromeOSDevice(){return this.browserOSUtils.isChromeOSDevice}get hasCoarsePointer(){return this._coarsePointerQuery?.matches??!1}get hasFinePointer(){return this._finePointerQuery?.matches??!1}get isTouchable(){return this.hasCoarsePointer}get isDeviceTouchOnly(){return this.isTouchable&&!this.hasFinePointer}get isDeviceFinePointerOnly(){return this.hasFinePointer&&!this.isTouchable}get isChromeBrowser(){return this.browserOSUtils.isChromeBrowser}get isFirefoxBrowser(){return this.browserOSUtils.isFirefoxBrowser}get isEdgeBrowser(){return this.browserOSUtils.isEdgeBrowser}get isSafariBrowser(){return this.browserOSUtils.isSafariBrowser}get isSamsungBrowser(){return this.browserOSUtils.isSamsungBrowser}isBraveBrowser(){return this.browserOSUtils.isBraveBrowser()}get isMobileWebView(){return this.browserOSUtils.isMobileWebView}get isAndroidApp(){return this.browserOSUtils.isAndroidApp}get isIOSApp(){return this.browserOSUtils.isIOSApp}get isIPadApp(){return this.browserOSUtils.isIPadApp}get isIosPlatformApp(){return this.isIOSApp||this.isIPadApp}get isChromeOSWeb(){return this.browserOSUtils.isChromeOSWeb}get isMsftPWA(){return this.browserOSUtils.isMsftPWA}get isNonMsftPWA(){return this.browserOSUtils.isNonMsftPWA}get PWAInstallationSource(){return this.browserOSUtils.PWAInstallationSource}get isMobileWeb(){return this.browserOSUtils.isMobileWeb}get isEmbedDesktop(){return this.browserOSUtils.isEmbedDesktop}get isEmbedWeb(){return this.browserOSUtils.isEmbedWeb}get isEmbedVideo(){return this.browserOSUtils.isEmbedVideo}get isEmbed(){return this.browserOSUtils.isEmbed}get deviceMemoryCategory(){const e=this.browserOSUtils.deviceOs;return e===r.OS.Mac||e===r.OS.Windows||e===r.OS.Linux?r.L9.high:e===r.OS.ChromeOS?r.L9.medium:r.L9.low}get platformType(){return this.isIOSApp?r.zh.iOSApp:this.isIPadApp?r.zh.iPadOSApp:this.isAndroidApp?r.zh.AndroidApp:this.isChromeOSWeb?r.zh.ChromeOSApp:this.isMobileWeb?r.zh.MobileWeb:r.zh.DesktopWeb}get platformTypeDetail(){if(this.isIOSApp||this.browserOSUtils.isEmbedIosWebView)return r.oF.iOSApp;if(this.isIPadApp)return r.oF.iPadOSApp;if(this.isAndroidApp||this.browserOSUtils.isEmbedAndroidWebView)return r.oF.AndroidApp;if(this.isDesktopShellApp)return r.oF.DesktopShell;if(this.isMsftPWA||this.isNonMsftPWA)return r.oF.DesktopPWA;if(this.isChromeOSWeb)return r.oF.DesktopWeb;if(this.isIPadOSDevice)return r.oF.MobileWebIPadOS;if(this.isMobileWeb){if(this.isAndroidDevice)return r.oF.MobileWebAndroid;if(this.isIOSDevice)return r.oF.MobileWebIOS}return r.oF.DesktopWeb}get isEmbedMobileWebView(){return this.browserOSUtils.isEmbedMobileWebView}get isEmbedIosWebView(){return this.browserOSUtils.isEmbedIosWebView}get isEmbedAndroidWebView(){return this.browserOSUtils.isEmbedAndroidWebView}get maxTouchPoints(){return this.browserOSUtils.maxTouchPoints}deviceOsVersionNumber(){return this.browserOSUtils.deviceOsVersionNumber()}async xmpAgentName(e,t,i,s=!1){return`${e.startsWith("Adobe ")?e:"Adobe "+e} ${t} (${this.deviceOs} ${await this.deviceOsVersionNumber()};${this.webBrowser} ${this.webBrowserVersion};${this.platformTypeDetail};sha:${i}${s?";adobe":""})`}constructor(e,t){super(),this._matchMedia=t,this._coarsePointerQuery=this._matchMedia("(any-pointer: coarse)"),this._finePointerQuery=this._matchMedia("(pointer: fine)"),this.browserOSUtils=new s.y(e)}}},977871:(e,t,i)=>{i.d(t,{L9:()=>o,OS:()=>s,QY:()=>r,oF:()=>a,zh:()=>n});var s=function(e){return e.Windows="Windows",e.ChromeOS="ChromeOS",e.Linux="Linux",e.Mac="Mac",e.iOS="iOS",e.iPadOS="iPadOS",e.Android="Android",e.Unknown="Unknown",e}({}),r=function(e){return e.Chrome="Chrome",e.Firefox="Firefox",e.Edge="Edge",e.Safari="Safari",e.Samsung="Samsung",e.WebKitBased="WebKitBased",e.WebView="NA",e.Unknown="Unknown",e}({}),o=function(e){return e.low="low",e.medium="medium",e.high="high",e}({}),n=function(e){return e.MobileWeb="mobile-web",e.DesktopWeb="desktop-web",e.iOSApp="ios-app",e.iPadOSApp="ipad-app",e.ChromeOSApp="chrome-app",e.AndroidApp="android-app",e}({}),a=function(e){return e.DesktopWeb="desktop-web-browser",e.DesktopPWA="desktop-web-pwa",e.MobileWebAndroid="mobile-web-android",e.MobileWebIOS="mobile-web-iOS",e.MobileWebIPadOS="mobile-web-ipadOS",e.iOSApp="mobile-app-iOS",e.iPadOSApp="mobile-app-ipadOS",e.AndroidApp="mobile-app-android",e.DesktopShell="desktop-shell",e}({})},616351:(e,t,i)=>{i.d(t,{A9:()=>o,eW:()=>s,st:()=>a,su:()=>r,xn:()=>n});var s=function(e){return e.default="default",e.noStore="no-store",e.reload="reload",e.noCache="no-cache",e.forceCache="force-cache",e.onlyIfCached="only-if-cached",e}({}),r=function(e){return e.omit="omit",e.sameOrigin="same-origin",e.include="include",e}({}),o=function(e){return e.follow="follow",e.error="error",e.manual="manual",e}({}),n=function(e){return e.noReferrer="no-referrer",e.noReferrerWhenDowngrade="no-referrer-when-downgrade",e.origin="origin",e.originWhenCrossOrigin="origin-when-cross-origin",e.sameOrigin="same-origin",e.strictOrigin="strict-origin",e.strictOriginWhenCrossOrigin="strict-origin-when-cross-origin",e.unsafeURL="unsafe-url",e}({}),a=function(e){return e[e.Browser=0]="Browser",e[e.Node=1]="Node",e[e.Worker=2]="Worker",e}({})},866893:(e,t,i)=>{i.d(t,{fC:()=>je});var s=i(616351),r=i(880990),o=i(430871),n=i(467046),a=i(993123),d=i(689858);var l=i(898459),c=i(126295),h=i(372899);const u=/access_token=[0-9A-Za-z-._%&=]+/,_="horizon_app_access_country",g=r.CA.DEVICE_NAME,f=r.CA.PLATFORM_TYPE,p=r.CA.EVENT_USER_AGENT,m=r.CA.EVENT_THREAD,w=r.CA.EVENT_ENVIRONMENT,E=r.CA.EVENT_ENVIRONMENT_TYPE,v=r.CA.MOBILE_ID,S=r.CA.MOBILE_INSTALL_DATE,b=r.CA.DEVICE_HEIGHT,y=r.CA.DEVICE_WIDTH,A=r.CA.EVENT_BUILD,C=r.CA.EVENT_BUILD_BRANCH,O=r.CA.EVENT_BUNDLE_HASH,P=r.CA.EVENT_OVERRIDES_CONFIGURATION_HASH,F=r.CA.EVENT_SOURCE_CLIENT_ID,I=r.CA.EVENT_SOURCE_NAME,T=r.CA.EVENT_SOURCE_VERSION,R=r.CA.EVENT_MOBILE_APP_VERSION,D=r.CA.EVENT_NETWORK_TYPE,L=r.CA.CONTEXT_WEBVIEW_ROLE,N=r.CA.EVENT_MOBILE_BUILD_TYPE,x=r.CA.EVENT_VIDEO_WEBCODECS_EXPERIENCE,k=r.CA.EVENT_REFERRER,U=r.CA.EVENT_URL,M=r.CA.EVENT_LOCALE,B=r.CA.DISPLAYED_LANGUAGE,V=r.CA.PROFILE_COUNTRY,W=r.CA.ACCESS_COUNTRY,z=r.CA.EVENT_SESSION_ID,G=r.CA.IS_NEW_USER,H=r.CA.USER_FIRST_ACCESS_TIME,j=r.CA.CUSTOM_USER_ADMIN_ROLE,q=r.CA.CUSTOM_USER_MANAGER_CAPABILITIES,$=r.CA.EVENT_MCID_GUID,Q=r.CA.SESSION_RECORDING_URL,Y=r.CA.EVENT_CONTEXT_GUID,K=r.CA.EVENT_USER_GUID,X=r.CA.EVENT_PROFILE_GUID,J=r.CA.USER_SERVICE_CODE,Z=r.CA.USER_SERVICE_LEVEL,ee=r.CA.USER_ACCOUNT_TYPE,te=r.CA.EVENT_GUID,ie=r.CA.EVENT_CATEGORY,se=r.CA.ORG_ID,re=r.CA.ENTITLEMENT_TYPE,oe=r.CA.GEN_AI_TOTAL_CREDITS,ne=r.CA.USER_COMPLIMENTARY_PREMIUM,ae=r.CA.IS_TRIAL_USER,de=r.CA.USER_TRIAL_DAYS_REMAINING,le=r.CA.USER_MARKET_SEGMENT,ce=r.CA.USER_OFFER_ID,he=r.CA.USER_BILLING_FREQUENCY,ue=r.CA.USER_NUMBER_OF_LICENSES,_e=r.CA.USER_STORE_UI,ge=r.CA.USER_SUBSCRIPTIONS,fe=r.CA.IS_EDU_USER,pe=r.CA.CUSTOM_USER_ID_TYPE,me=r.CA.CUSTOM_USER_OFFERING,we=r.CA.EVENT_APE_GUID,Ee=r.CA.EVENT_APE_STATUS,ve=r.CA.EVENT_APE_DURATION,Se=r.CA.EVENT_APE_TIME_SINCE_LAST_EVENT,be=r.CA.APE_START_TIME,ye=r.CA.APE_LAST_EVENT_TIME,Ae=r.CA.CONTEXT_USER_ROLE,Ce=r.CA.CONTEXT_GUID,Oe=r.CA.CONTENT_SCHEMA_VERSION,Pe=r.CA.EXPERIMENTS_ASSIGNED,Fe=r.CA.EXPERIMENTS_EXPOSED,Ie=r.CA.GLOBAL_HOLDOUTS_ASSIGNED,Te=r.CA.FEATURE_ROLLOUTS_ASSIGNED,Re=r.CA.CUSTOM_REFERRER_APP,De=r.CA.CUSTOM_REFERRER_ACTION,Le=r.CA.CUSTOM_REFERRER_ASSET_ID,Ne=r.CA.CUSTOM_REFERRER_INTENT,xe=r.CA.CUSTOM_REFERRER_LANDING_TAB,ke=r.CA.EVENT_SOURCE_OS_VERSION,Ue=r.CA.EVENT_SOURCE_OS_NAME,Me=r.CA.EVENT_SOURCE_DEVICE_MODEL,Be=r.CA.EVENT_SOURCE_BROWSER_NAME,Ve=r.CA.EVENT_SOURCE_BROWSER_VERSION,We=r.CA.EVENT_SOURCE_PLATFORM_TYPE_DETAIL,ze=r.CA.CUSTOM_FOCUS_MODE_TYPE,Ge=[p,A,C,O,P,Ce,k,U,M,W,V,re,E,w,$,Q,z,K,ee,G,j,q,fe,pe,me,Pe,Fe,Te,Ie,J,Z,F,f,D,L,g,b,y,Re,De,Le,Ne,xe,Ue,ke,Me,Be,We,B,se,we,be,ye,ae,de,le,ce,he,ue,_e,ge],He=[ke,v,S];class je{async _initAccessCountry(){await this._accessCountryPromise}async _initIMSUserData(){await this._IMSUserData}async _initIMSIdData(){await this._IMSIdData}_createInitTimeout(){return new Promise(((e,t)=>{this._initTimeoutId=setTimeout((()=>{e()}),3e3)}))}async _initDataFromBrowserService(){(await this._hostPromise).executionEnvironment()===s.st.Browser&&(this._browserService??(this._browserService=new o.qD(window.navigator,window.matchMedia.bind(window))),this._data[Ue]=this._browserService.deviceOs,this._data[Ve]=this._browserService.webBrowserVersion,this._data[We]=this._browserService.platformTypeDetail,this._data[Be]=this._browserService.webBrowser,this._data[Me]=await this._browserService.deviceModel,this._data[ke]=await this._browserService.deviceOsVersionNumber())}async _initDataFromABPProfile(){if((await this._hostPromise).executionEnvironment()===s.st.Browser&&this._abpProfileService)try{const e=await this._configPromise;if(!e.useSubscriptionProfile)return;const t=await this._abpProfileService.fetchAnalyticsData([l.s.FULFILLABLE_ITEMS,l.s.OFFER_DETAILS,l.s.APP_STORE_DETAILS]);t&&this._updateABPProfileData(t)}catch(e){console.error("Failed to get ABP profile data",e)}}_updateABPProfileData(e){this._data[ae]=e.isTrialUser?"true":"false",this._data[de]=e.trialDaysRemaining?String(e.trialDaysRemaining):r.kC.NOT_APPLICABLE,e.marketSegment&&(this._data[le]=e.marketSegment),e.offerId&&(this._data[ce]=e.offerId),e.billingFrequency?this._data[he]=e.billingFrequency:this._data[he]=r.kC.NOT_APPLICABLE,this._data[ue]=String(e.numberOfLicenses),e.storeId&&(this._data[_e]=e.storeId),e.subscriptions.length>0&&(this._data[ge]=JSON.stringify(e.subscriptions)),this._broadcastABPProfileUpdate()}_broadcastABPProfileUpdate(){this._broadcastUpdate([ae,de,le,ce,he,ue,_e,ge])}reinitPlatformTypeDetailAfterPWAInstall(){this._data[We]=this._browserService.platformTypeDetail,this._broadcastUpdate([We])}async _initDeviceContext(){const e=await this._hostPromise,t=e.deviceAgent();switch(this._data[p]=t,this._data[D]=this._getNetworkTypeForAnalytics(e),e.executionEnvironment()){case s.st.Browser:{this._data[m]="main";const e=t.match(/(iPad)|(iPhone)|(iPod)|(android)|(webOS)/i),i=t.match(/(Macintosh)/i),r=window?.navigator?.maxTouchPoints>0;e?(this._browserService??(this._browserService=new o.qD(window.navigator,window.matchMedia.bind(window))),this._browserService.isEmbedAndroidWebView?this._data[f]="android":this._browserService.isEmbedIosWebView?this._data[f]="iOS":!1===(0,a.eW)(s.st.Browser)?this._data[f]="mobile-web":((0,a.PR)()&&(this._data[f]="android"),(0,a.te)()&&(this._data[f]="iOS"))):this._data[f]=i&&r?"mobile-web":"desktop-web",this._data[g]=this.extractDeviceName(t),window?.addEventListener("resize",this._windowResizeHandler),this._windowResizeHandlerLoaded=!0,this.extractDeviceDimensions(window);break}case s.st.Node:this._data[m]="main";break;case s.st.Worker:this._data[m]="worker-thread"}}_getNetworkTypeForAnalytics(e){const t=e.connection()?.effectiveType,i=e.connection()?.type;return void 0===t?r.kC.NOT_SPECIFIED:void 0===i?t:`${t}/${i}`}async _initAppContext(){const e=await this._configPromise;this._data[A]=`${e.includeIngestBuildPrefix?"prod"===e.envName?"prod:":"stage:":""}${e.buildInfo.sha}`,this._data[C]=e.buildInfo.branch,this._data[O]=e.bundleHash,this._data[ie]=e.ingestAppCategory,this._data[w]=e.envName,this._data[E]=e.env,this._data[I]=e.appSAPCode,this._data[T]=e.appVersion}async _initPageContext(){if((await this._hostPromise).executionEnvironment()===s.st.Browser){const e=this._documentHref();this._data[U]=e.replace(u,""),this._data[k]=document.referrer}}_documentHref(){return document.location.href}async _initMcidGuidContext(){const e=await this._hostPromise,t=e.deviceLanguage();this._data[M]=t;const i=(await this._configPromise).useExperienceEdge;e.executionEnvironment()===s.st.Browser&&i&&(this.mcidGuid=await this._marketingTechService.mcidGuid())}_setAndResolveAccessCountry(e){e&&""!==e.trim()&&(this._data[W]=e,this._broadcastUpdate([W]),this._resolveAccessCountry&&this._resolveAccessCountry())}async fetchGeo2location(){return await(0,h.XD)((async()=>{const e=await fetch("https://geo2.adobe.com/json/");if(!e.ok)throw new Error(`HTTP ${e.status}: ${e.statusText}`);return await e.text()}),{delay:100,progressMessagePrefix:"[AnalyticsContext:fetchGeo2location]"})()}async extractAccessCountry(){if((await this._hostPromise).executionEnvironment()===s.st.Browser){const e=sessionStorage.getItem(_);if(e)this._setAndResolveAccessCountry(e);else try{const e=await this.fetchGeo2location();if(e){const t=JSON.parse(e),i=String(t.country);sessionStorage.setItem(_,i),this._setAndResolveAccessCountry(i)}else this._setAndResolveAccessCountry("")}catch(e){console.error("Failed to get location data from geo2.adobe.com",e),this._setAndResolveAccessCountry("")}}}_initDocContext(){this._data[Ce]="",this._data[Oe]="",this._data[Ae]=""}async userIdInitialized(){await this._initIMSUserData()}async initialized(){this._initialized||(await this._initPromise,clearTimeout(this._initTimeoutId),this._initialized=!0)}isInitialized(){return this._initialized}shutdown(){clearTimeout(this._initTimeoutId),this._windowResizeHandlerLoaded&&window?.removeEventListener("resize",this._windowResizeHandler)}updateShellAppContext(e){e&&0!==Object.keys(e).length&&!0===(0,a.eW)(s.st.Browser)&&(this.updateFromPayload(e),this._broadcastUpdate(Object.keys(e)))}startNewApeSession(e,t){this.apeGuid=(0,d.Z)(),this.apeStartTime=t,this.apeLastEventTime=t,e[Ee]="start",e[we]=this.apeGuid,e[ve]=0,e[Se]=0}processApeMetrics(e){const t="active"===e?.[Ee],i=new Date;if(this.apeGuid){const s=(i.getTime()-this.apeLastEventTime.getTime())/1e3;if(s<=1200){if(e[we]=this.apeGuid,t){this.apeLastEventTime=i;const t=(i.getTime()-this.apeStartTime.getTime())/1e3;e[Se]=s,e[ve]=t}}else t?this.startNewApeSession(e,i):(this.apeGuid="",e[we]=r.gh)}else t?this.startNewApeSession(e,i):e[we]=r.gh}adornEventData(e){Object.keys(this._data).forEach((t=>{e[t]||(e[t]=this._data[t])}));try{this.processApeMetrics(e)}catch(e){console.warn("Error processing APE metrics",e)}delete e[ye],delete e[be],e[te]=e[te]||(0,d.Z)(),!e[Ce]&&this.currentAssetId&&(e[Ce]=this.currentAssetId),e[r.CA.EVENT_TIME_START]||(e[r.CA.EVENT_TIME_START]=(new Date).toISOString()),e[r.CA.EVENT_COUNT]||e[r.CA.EVENT_WORKFLOW]===r.kC.WORKFLOW_DEBUG||(e[r.CA.EVENT_COUNT]=1);const t=function(){if("undefined"!=typeof window&&window.FS)return window.FS("getSession",{format:"url.now"})}();t&&(e[r.CA.SESSION_RECORDING_URL]=t),"checkout-complete"===e[r.CA.EVENT_PAGENAME]&&setTimeout((()=>{this._initDataFromABPProfile().catch((e=>{console.error("ABP Profile refresh after checkout failed:",e)}))}),3e4)}addListener(e){this._listeners.add(e)}deleteListener(e){this._listeners.delete(e)}_callListeners(e){this._listeners.forEach((t=>{t(e)}))}generateInitPayload(){const e=Object.values(r.eN).filter((e=>Boolean(this._data[e]))),t=[...Ge,...e];if(!0===(0,a.eW)(s.st.Browser)){const e=Object.values(He).filter((e=>Boolean(this._data[e])));t.push(...e)}return this._embedParams.length&&t.push(...this._embedParams),this._generatePayload(t)}_generatePayload(e){const t={};return e.forEach((e=>{e in this._data?t[e]=this._data[e]:t[e]=void 0})),t}_broadcastUpdate(e){this._callListeners(this._generatePayload(e))}async updateFromPayload(e){await this.initialized();Object.keys(e).forEach((t=>{void 0===e[t]?delete this._data[t]:this._data[t]=e[t]}))}addContextGUID(e){this._data[Y]=e}removeContextGUID(){delete this._data[Y]}set imsProfile(e){const t=e.account_type,i=[];let s;if(this._data[K]=String(e.userId),this._data[ee]=String(t),e.profileId&&(this._data[X]=String(e.profileId),i.push(X)),e.countryCode&&(this._data[V]=String(e.countryCode),i.push(V)),e.serviceAccounts&&(s=e.serviceAccounts.find((e=>"creative_cloud"===e.serviceCode))),this._data[Z]=s?s.serviceLevel:"",this._data[J]=s?s.serviceCode:"",e.email){const t=e.email.toLowerCase();(t.endsWith("@adobe.com")||t.endsWith("@adobetest.com"))&&(this._data[J]+="_adobe")}e.ownerOrg&&(this._data[se]=e.ownerOrg,i.push(se)),this._broadcastUpdate([K,ee,Z,J,...i]),this._resolveIMSUserData&&this._resolveIMSUserData()}set imsIdData(e){const t=e.client_id||"no-client-id";this._data[F]=t,this._broadcastUpdate([F]),this._resolveIMSIdData&&this._resolveIMSIdData()}set pageURL(e){this._data[U]=e.replace(u,""),this._broadcastUpdate([U])}get isInternalUser(){return String(this._data[J]).endsWith("_adobe")}set accessCountry(e){this._setAndResolveAccessCountry(e)}get accessCountry(){return this._data[W]}set threadName(e){this._data[m]=e}get threadName(){return this._data[m]}get deviceName(){return this._data[f]}set mcidGuid(e){this._data[$]=e,this._broadcastUpdate([$])}get mcidGuid(){return this._data[$]}set apeGuid(e){this._data[we]=e,this._broadcastUpdate([we])}get apeGuid(){return this._data[we]}set apeStartTime(e){this._data[be]=e.toISOString(),this._broadcastUpdate([be])}get apeStartTime(){return new Date(this._data[be])}set apeLastEventTime(e){this._data[ye]=e.toISOString(),this._broadcastUpdate([ye])}get apeLastEventTime(){return new Date(this._data[ye])}set expressEntitlementType(e){this._data[re]=e,this._broadcastUpdate([re])}get expressEntitlementType(){return this._data[re]}set genAITotalCredits(e){this._data[oe]=String(e),this._broadcastUpdate([oe])}get genAITotalCredits(){return Number(this._data[oe])}set userComplimentaryPremium(e){this._data[ne]=e,this._broadcastUpdate([ne])}get userComplimentaryPremium(){return this._data[ne]}set sessionRecordingUrl(e){this._data[Q]=e,this._broadcastUpdate([Q])}get sessionRecordingUrl(){return this._data[Q]}set sessionId(e){this._data[z]=e,this._broadcastUpdate([z])}get sessionId(){return this._data[z]}get newUserStatus(){return this._data[G]}get userFirstAccessTime(){return this._data[H]}set newUserStatus(e){this._data[G]=e,this._broadcastUpdate([G])}set userFirstAccessTime(e){this._data[H]=e,this._broadcastUpdate([H])}get customUserAdminRole(){return this._data[j]}set customUserAdminRole(e){this._data[j]=e,this._broadcastUpdate([j])}get customUserManagerCapabilities(){return this._data[q]}set customUserManagerCapabilities(e){this._data[q]=e,this._broadcastUpdate([q])}get eduUserStatus(){return this._data[fe]}set eduUserStatus(e){this._data[fe]=e,this._broadcastUpdate([fe])}get eduUserIdTypeStatus(){return this._data[pe]}set eduUserIdTypeStatus(e){this._data[pe]=e,this._broadcastUpdate([pe])}get userOffering(){return this._data[me]}set userOffering(e){this._data[me]=e,this._broadcastUpdate([me])}get displayedLanguage(){return this._data[B]}set displayedLanguage(e){this._data[B]=e,this._broadcastUpdate([B])}set userHasEditRights(e){this._data[Ae]=e?"editor":"viewer",this._broadcastUpdate([Ae])}set currentAssetId(e){this._data[Ce]=e,this._broadcastUpdate([Ce])}async setEmbedContextAndParams(e){this._embedParams=Object.keys(e),await this.updateFromPayload(e),this._broadcastUpdate(Object.keys(e))}async setFocusMode(e){await this.initialized(),e?this._data[ze]=e:delete this._data[ze],this._broadcastUpdate([ze])}set currentDocumentVersion(e){this._data[Oe]=e,this._broadcastUpdate([Oe])}async experimentsMetadata(){return this._loadExperimentsDeferred.promise}async featureRolloutsMetadata(){return this._loadFeatureRolloutsDeferred.promise}async globalHoldoutsMetadata(){return this._loadGlobalHoldoutsDeferred.promise}set assignedExperiments(e){""!==e&&this._loadExperimentsDeferred.resolve(e),this._data[Pe]=e,this._broadcastUpdate([Pe])}set exposedExperiments(e){this._data[Fe]=e,this._broadcastUpdate([Fe])}set featureRollouts(e){this._loadFeatureRolloutsDeferred.resolve(e),this._data[Te]=e,this._broadcastUpdate([Te])}get exposedExperiments(){return this._data[Fe]}set assignedOverridesConfigurationHash(e){this._data[P]=e,this._broadcastUpdate([P])}set globalHoldouts(e){""!==e&&this._loadGlobalHoldoutsDeferred.resolve(e),this._data[Ie]=e,this._broadcastUpdate([Ie])}extractDeviceDimensions(e){const t=e?.outerHeight,i=e?.outerWidth;this._data[b]&&0===t||(this._data[b]=String(t),this._data[y]=String(i),this._broadcastUpdate([b,y]))}extractDeviceName(e){const t=e.match("\\(([^)]+)\\)");return t?t[1]:e}get osVersion(){return this._data[ke]}get appVersion(){return this._data[T]}get appName(){return this._data[I]}get userId(){return this._data[K]}get mobileAppVersion(){return this._data[R]}addCampaignProperties(e){if(e&&Object.keys(e).length>0)for(const t in e)this._data[t]=e[t]}get customReferrerApp(){return this._data[Re]}get customCampaingReferrerApp(){return this._data[r.eN.MV2]}get customCampaignSDID(){return this._data[r.eN.SDID]}get customReferrerIntent(){return this._data[Ne]}set mobileBuildType(e){this._data[N]=e}get mobileBuildType(){return this._data[N]}get videoWebCodecsExperience(){return"true"===this._data[x]}set videoWebCodecsExperience(e){this._data[x]=e.toString()}set referrerAction(e){this._data[De]=e,this._setItemInSessionStorage(De,e)}_extractAndSetReferrerAction(){const e=this._getItemFromSessionStorage(De);e&&(this._data[De]=e)}_setItemInSessionStorage(e,t){"undefined"!=typeof sessionStorage&&sessionStorage.setItem(e,t)}_getItemFromSessionStorage(e){return"undefined"==typeof sessionStorage?null:sessionStorage.getItem(e)}constructor(e,t,i,s,o){this._initTimeoutId=0,this._embedParams=[],this._initAttributesPromises=[],this._loadExperimentsDeferred=new c.B,this._loadFeatureRolloutsDeferred=new c.B,this._loadGlobalHoldoutsDeferred=new c.B,this._accessCountryPromise=new Promise(((e,t)=>{this._resolveAccessCountry=()=>{this._resolveAccessCountry=void 0,e()}})),this._IMSUserData=new Promise(((e,t)=>{this._resolveIMSUserData=()=>{this._resolveIMSUserData=void 0,e()}})),this._IMSIdData=new Promise(((e,t)=>{this._resolveIMSIdData=()=>{this._resolveIMSIdData=void 0,e()}})),this._windowResizeHandler=(0,n.Z)((()=>this.extractDeviceDimensions(window)),r.zi),this._windowResizeHandlerLoaded=!1,this._initialized=!1,this._data={},this._listeners=new Set,this._hostPromise=e,this._configPromise=i,this._marketingTechService=s,this._abpProfileService=o||l.T.defaultInstance,this._data[z]=t,this.assignedExperiments="",this.exposedExperiments="",this.assignedOverridesConfigurationHash="",this.globalHoldouts="",this._initAttributesPromises=[this._hostPromise,this._configPromise,this._initDeviceContext(),this._initMcidGuidContext(),this._initAppContext(),this._initPageContext(),this._initAccessCountry(),this._initIMSUserData(),this._initDataFromBrowserService(),this._initIMSIdData(),this._initDataFromABPProfile()];const a=this._createInitTimeout(),d=Promise.allSettled(this._initAttributesPromises);this._initPromise=Promise.race([d,a]),this._initDocContext(),this.extractAccessCountry(),this._extractAndSetReferrerAction()}}},12616:(e,t,i)=>{i.d(t,{NH:()=>o});var s=i(880990),r=i(126295);class o{async shutdown(){await this._initializedPromise,clearInterval(this._queueIntervalHandle),this._queueIntervalHandle=void 0,await this._processQueueAsync()}async start(e){this._initializedPromise=this._processOnceInitialized(e),await this._initializedPromise}async _processOnceInitialized(e){this._isInitialized=!0,this._queueIntervalHandle=setInterval((()=>{this._processQueue()}),e),this._processQueue()}async initialized(){return this._initializedPromise}_isLowPriority(e){return e[s.CA.LOG_LEVEL]!==s.kC.LOG_LEVEL_ERROR}_isOverflow(){return this._events.length>this._maxQueueLength}_handleOverflow(){this._overflowedEventsCount++;let e=!1;for(let t=0;t<this._events.length;t++)if(this._isLowPriority(this._events[t])){e=!0,console.warn("EventQueue overflow with High Priority Event, dropping log event below error level."),this._events.splice(t,1);break}e||(console.error("EventQueue overflow, dropping important event."),this._events.shift())}queueEventData(e){this._events.push(e),this._isOverflow()&&this._handleOverflow(),this._isInitialized&&this._events.length>=this._batchSize&&this._processQueue()}async _processQueueAsync(){if(this._queueIsSending)return this._queueIsSending.promise;if(this._events.length){for(this._queueIsSending=new r.B;this._events.length>0;)try{const e=this._events.slice(0,Math.min(this._events.length,this._batchSize));await this._eventDeliveryFunction(e),this._events.splice(0,Math.min(e.length,this._batchSize))}catch(e){console.error("EventQueue: encountered an error trying to send events to Ingest",e);break}this._queueIsSending.resolve(),this._queueIsSending=void 0}}_processQueue(){this._queueIsSending||this._processQueueAsync()}get maxQueueLength(){return this._maxQueueLength}set maxQueueLength(e){this._maxQueueLength=e}get batchSize(){return this._batchSize}set batchSize(e){this._batchSize=e}get overflowedEventsCount(){return this._overflowedEventsCount}get queueIsSendingPromise(){return this._queueIsSending?.promise}get queueLength(){return this._events.length}constructor(e){this._eventDeliveryFunction=e,this._maxQueueLength=500,this._batchSize=10,this._isInitialized=!1,this._overflowedEventsCount=0,this._events=[]}}},439679:(e,t,i)=>{i.d(t,{G:()=>s,e:()=>r});var s=function(e){return e[e.offline=0]="offline",e[e.online=1]="online",e}({});class r{_updateNetworkState(e){this._currentState!==e&&(this._currentState=e,this._networkStateCallback?.(this.onLine))}get onLine(){return 1===this._currentState}setNetworkStateCallback(e){this._networkStateCallback=e}constructor(){this._currentState=1}}},971464:(e,t,i)=>{i.d(t,{h:()=>h});var s=i(616351),r=i(126295),o=i(372899),n=i(880990),a=i(993123),d=i(430871);const l=["adobePrivacy:PrivacyConsent","adobePrivacy:PrivacyCustom","adobePrivacy:PrivacyReject"],c="PrivacyServiceError: Failed to load";class h{addConsentChangeListener(e,t){this.load().then((()=>{if((0,a.eW)(s.st.Browser))return Promise.resolve();if(this._host.executionEnvironment()===s.st.Browser){if(this._browserService??(this._browserService=new d.qD(window.navigator,window.matchMedia.bind(window))),this._browserService.isEmbedDesktop)return Promise.resolve();this._addPrivacyListener(e),e()}})).catch((e=>{console.error(e),t([{[n.CA.EVENT_WORKFLOW]:"Debug",[n.CA.EVENT_SUBTYPE]:"log",[n.CA.EVENT_TYPE]:"failure",error:e}])}))}_addPrivacyListener(e,t=!1){const i=t?()=>{e(),l.forEach((e=>{window.removeEventListener(e,i)}))}:e;l.forEach((e=>{window.addEventListener(e,i)}))}_registerLoadListeners(){this._addPrivacyListener(this._onLoadHandler.bind(this),!0)}_registerConfigs(){const{otDomainId:e,footerLinkSelector:t,documentLanguage:i}=this._config,s={otDomainId:e};t&&(s.footerLinkSelector=t),i&&(s.documentLanguage=i),window.fedsConfig=window.fedsConfig||{privacy:s}}async _loadPrivacy(){if(this._host.executionEnvironment()===s.st.Browser){this._registerConfigs(),this._registerLoadListeners();(0,o.XD)((async()=>new Promise(((e,t)=>{const i=document.createElement("script");i.src=this._config.privacyUrl,i.async=!0;const s=()=>{o(),t(new Error(c))},r=()=>{o(),e()},o=()=>{i.removeEventListener("error",s),i.removeEventListener("load",r)};i.addEventListener("error",s),i.addEventListener("load",r),document.head.appendChild(i)}))),{maxAttempts:10,delay:250,progressMessagePrefix:"[PrivacyService]"})().catch((()=>{!this._loadPromise?.isSettled&&this._loadPromise?.reject(c)}))}else!this._loadPromise?.isSettled&&this._loadPromise?.resolve()}async load(){return this._loadPromise?this._loadPromise.promise:(this._loadPromise=new r.B,(0,a.eW)(s.st.Browser)?this._loadPromise?.promise:(await this._hostConfigPromises,this._host.executionEnvironment()===s.st.Browser&&(this._browserService??(this._browserService=new d.qD(window.navigator,window.matchMedia.bind(window))),this._browserService.isEmbedDesktop||this._browserService.isEmbedVideo)||this._loadPrivacy().catch((()=>{!this._loadPromise?.isSettled&&this._loadPromise?.reject(c)})),this._loadPromise?.promise))}resolvePrivacyLoadInNativeAppShell(){this._loadPromise?.resolve()}rejectLoadPromise(){this._loadPromise?.reject(c)}constructor(e,t){this._onLoadHandler=()=>{this._loadPromise?.isSettled||(window.adobePrivacy?this._loadPromise?.resolve():this._loadPromise?.reject("PrivacyServiceError: window.adobePrivacy API is not available after load event."))},this._hostConfigPromises=Promise.all([e,t]).then((([e,t])=>{this._config=t,this._host=e}))}}},898459:(e,t,i)=>{i.d(t,{T:()=>l,s:()=>d});var s=i(616351),r=i(332805),o=i(372899),n=i(696050);const a="LICENSE";var d=function(e){return e.FULFILLABLE_ITEMS="FULFILLABLE_ITEMS",e.OFFER_DETAILS="OFFER_DETAILS",e.APP_STORE_DETAILS="APP_STORE_DETAILS",e}({});class l{static get defaultInstance(){if(l._defaultInstance)return l._defaultInstance;const e=r.y.singleton(),t=e.attach(n.q).then((()=>({subscriptionProfileAPIKey:n.q.subscriptionProfileAPIKey.value,subscriptionProfileHost:n.q.subscriptionProfileHost.value,subscriptionProfileEndpoint:n.q.subscriptionProfileEndpoint.value})));return l._defaultInstance=new l(e.getHost(),t),l._defaultInstance}static _resetInstance(){l._defaultInstance=void 0}async _getAccessToken(){if(!this._host||this._host.executionEnvironment()!==s.st.Browser)return;const e=(0,o.XD)((async()=>{if(!globalThis.window?.adobeIMS)throw new Error("adobeIMS not available in the browser window object, retrying...");const e=await globalThis.window.adobeIMS.getAccessToken();if(!e?.token)throw new Error("No access token available from IMS, retrying...");this._accessToken=`Bearer ${e.token}`}),{timeoutInterval:1e4,shouldRetry:()=>!this._accessToken});try{await e()}catch{}}async _initialized(){try{await this._hostConfigPromise,await this._getAccessToken()}catch(e){console.error("Failed to initialize ABPProfileService config/host - subscription profile features will be unavailable",e)}this._isInitialized=!0}_buildUrl(e){const t=`${this._config.subscriptionProfileHost}${this._config.subscriptionProfileEndpoint}`,i=new URLSearchParams;e.length>0&&i.append("include_sections",e.join(",")),i.append("include_derived_attributes","true");const s=i.toString();return s?`${t}?${s}`:t}_getHeaders(){return this._accessToken?{"Content-Type":"application/json",Authorization:this._accessToken,"Access-Control-Request-Headers":"Authorization","X-Api-Key":this._config.subscriptionProfileAPIKey}:null}async _fetchOnce(e,t){const i=await fetch(e,{method:"GET",headers:t});if(206===i.status){try{const e=await i.json();this._partialResponseData=this._mergePartialResponse(this._partialResponseData,e)}catch(e){throw console.warn("ABP Profile parse error on partial response:",e),e}throw new Error("Partial response (206) - retrying to get complete data")}if(i.ok){const e=await i.json(),t=this._mergePartialResponse(this._partialResponseData,e);return this._partialResponseData={},t}{const e=`HTTP ${i.status}: ${i.statusText}`;throw new Error(e)}}async _fetchWithRetry(e,t){try{this._partialResponseData={};const i=(0,o.XD)((()=>this._fetchOnce(e,t)),{maxAttempts:this._maxRequestCount,delay:2e3,progressCallback:(e,t,i)=>{i&&console.warn(`ABP Profile: ${e}`,t,i)},progressMessagePrefix:"ABP Profile fetch"});return await i()}catch(e){if(this._partialResponseData.commerce_profile?.subscriptions&&this._partialResponseData.commerce_profile.subscriptions.length>0){const e=this._partialResponseData;return this._partialResponseData={},e}return console.error("Failed to fetch ABP profile after all retries",e),this._partialResponseData={},null}}_mergePartialResponse(e,t){var i,s;if((i=e).commerce_profile??(i.commerce_profile={}),(s=e.commerce_profile).subscriptions??(s.subscriptions=[]),t.commerce_profile?.subscriptions){const i=new Set(e.commerce_profile.subscriptions.map((e=>e.source?.id)));for(const s of t.commerce_profile.subscriptions)i.has(s.source?.id)||e.commerce_profile.subscriptions.push(s)}return e}_parseTrialDetails(e){return!0!==e.trial_details?.in_trial_period?null:{isUserInTrial:!0,trialDaysRemaining:e.trial_details.trial_days_remaining}}_parseOfferDetails(e){const t=[],i=e.offer_details||[];for(const e of i){const i={term:e.term,offerId:e.offer_id,customerSegment:e.customer_segment,commitment:e.commitment,paCode:e.product_arrangement?.code,paFamily:e.product_arrangement?.family,paName:e.product_arrangement?.name,paCloud:e.product_arrangement?.cloud};e.market_segments&&e.market_segments.length>0&&(i.marketSegment=e.market_segments[0]),t.push(i)}return t}_parseResponse(e,t){if(0===t.length)return[];const i=[];for(const e of t){const t={};if(e.source&&(e.source.type&&(t.type=e.source.type),e.source.id&&(t.id=e.source.id),e.source.group_id&&(t.group_id=e.source.group_id)),e.trial_details){const i=this._parseTrialDetails(e);i&&Object.assign(t,i)}if(e.offer_details&&e.offer_details.length>0){const i=this._parseOfferDetails(e);i.length>0&&Object.assign(t,i[0])}e.app_store_details?.store_id&&(t.storeId=e.app_store_details.store_id),t.type&&t.id&&i.push(t)}return i}_countLicensedSubscriptions(e){return e.filter((e=>e.type?.includes(a))).length}_findPrimarySubscription(e){if(0===e.length)return;const t=e.find((e=>e.type?.includes(a)&&e.paFamily?.includes("CC_")));if(t)return t;const i=e.find((e=>e.type?.includes(a)));return i||e[0]}_extractAnalyticsData(e){const t={isTrialUser:!1,numberOfLicenses:0,subscriptions:e};if(0===e.length)return t;const i=this._findPrimarySubscription(e);return i?(i.isUserInTrial&&(t.isTrialUser=!0,t.trialDaysRemaining=i.trialDaysRemaining),i.marketSegment&&(t.marketSegment=i.marketSegment),i.offerId&&(t.offerId=i.offerId),i.term&&(t.billingFrequency="NONE"===i.term?void 0:i.term),i.storeId&&(t.storeId=i.storeId),t.numberOfLicenses=this._countLicensedSubscriptions(e),t):t}async fetchAnalyticsData(e){try{if(this._isInitialized||await this._initPromise,!this._host||this._host.executionEnvironment()!==s.st.Browser)return null;if(!this._accessToken)return console.warn("Access token not available - skipping ABP profile fetch"),null;if(!this._config?.subscriptionProfileAPIKey||!this._config?.subscriptionProfileHost||!this._config?.subscriptionProfileEndpoint)return null;const t=this._getHeaders();if(!t)return console.warn("Unable to build request headers - skipping ABP profile fetch"),null;const i=e.map((e=>e.toString())),r=!0;let o;try{o=this._buildUrl(i)}catch(e){return console.error("Failed to build ABP profile URL",e),null}const n={uri:o,sections:i,hasDerivedAttributes:r},a=await this._fetchWithRetry(n.uri,t);if(!a)return null;const d=a.commerce_profile?.subscriptions||[];if(0===d.length)return null;let l;try{l=this._parseResponse(n,d)}catch(e){return console.error("Failed to parse ABP profile response",e),null}if(0===l.length)return null;try{return this._extractAnalyticsData(l)}catch(e){return console.error("Failed to extract analytics data from ABP profile",e),null}}catch(e){return console.error("Unexpected error in fetchAnalyticsData - subscription profile features will be unavailable",e),null}}constructor(e,t){this._isInitialized=!1,this._maxRequestCount=5,this._partialResponseData={},this._hostConfigPromise=Promise.all([e,t]).then((([e,t])=>{this._host=e,this._config=t})).catch((()=>{})),this._initPromise=this._initialized()}}},629609:(e,t,i)=>{i.d(t,{v:()=>a});var s=i(856556),r=i(372899),o=i(12616),n=i(439679);class a{async shutdown(e=!0){this._waitForQueueToFlush=e,await this._initializedPromise,await this._eventQueue.shutdown(),await this._ingestService.shutdown(),this._waitForQueueToFlush=!0}async _processOnceInitialized(){await this._ingestService.initialized();const e=await this._configPromise;this._eventQueue.maxQueueLength=e.analyticsBufferLimit,await this._eventQueue.start(e.ingestProcessingInterval)}async initialized(){return this._initializedPromise}queueEventData(e){this._eventQueue.queueEventData(e)}async _eventQueueDeliveryFunction(e){const t={maxAttempts:this._waitForQueueToFlush?3:1,shouldRetry:e=>!!this._waitForQueueToFlush&&(e instanceof s.o&&e.network&&this._callback(n.G.offline),!(e instanceof s.o&&!1===e.retryable)),delay:500},i=(0,r.XD)(this._ingestService.sendEventData,t);this._waitForQueueToFlush?await i(e):this._ingestService.sendEventData(e),this._callback(n.G.online)}constructor(e,t,i){this._callback=i,this._waitForQueueToFlush=!0,this._configPromise=t,this._ingestService=s.k.createInstance(e,t.then((e=>e.ingestConfig))),this._eventQueue=new o.NH(this._eventQueueDeliveryFunction.bind(this)),this._initializedPromise=this._processOnceInitialized()}}},856556:(e,t,i)=>{i.d(t,{k:()=>c,o:()=>l});var s=i(616351),r=i(880990),o=i(689858),n=i(198194);const a=[r.CA.ERROR_FULL_STACK,r.CA.ERROR_LOG_METADATA,r.CA.EVENT_URL],d=[r.CA.LOG_METADATA,r.CA.ERROR_LOG_METADATA];let l=class extends Error{constructor(e,{network:t,retryable:i}={}){super(e),this.name="IngestAPIError",this.retryable=i??!0,this.network=t??!1}},c=class e{_setVisibilityChangePromise(){this._windowVisibilityChangeHiddenPromise=new Promise((e=>{document.addEventListener("visibilitychange",(()=>{this._useKeepaliveForFetch="visible"!==document.visibilityState,e()}))}))}static createInstance(t,i){return new e(t,i)}async initialized(){await this._initPromise}async shutdown(e=5e3){const t=Array.from(this._pendingRequests);0!==t.length&&(await Promise.race([Promise.allSettled(t),new Promise((t=>setTimeout(t,e)))]),this._pendingRequests.clear())}_getHeaders(){return{"Content-Type":"application/json","x-api-key":this._config.ingestApiKey}}_adornSDMEvent(e){e[r.CA.EVENT_GUID]=e[r.CA.EVENT_GUID]||(0,o.Z)(),e[r.CA.EVENT_CATEGORY]=this._config.ingestAppCategory}_redactTokens(e){const t=/access_token=ey[0-9A-Za-z-._%=]+/g,i=/accessToken=ey[0-9A-Za-z-._%=]+/g,s=/Bearer ey[0-9A-Za-z-._%=]+/g;for(const i of a)this._redactSingleToken(e,i,t,"access_token=XXaccess_token_redactedXX");for(const t of d)this._redactSingleToken(e,t,s,"XXbearer_token_redactedXX"),this._redactSingleToken(e,t,i,"accessToken=XXaccess_token_redactedXX")}_redactSingleToken(e,t,i,s){if(e[t])if("string"!=typeof e[t])for(const r in e[t])this._redactSingleToken(e[t],r,i,s);else e[t]=e[t].replace(i,s)}_wrapSDMData(e){const t={};return t[r.CA.EVENT_PKG_INGEST_TYPE]=r.kC.INGEST_TYPE,e[r.CA.OVERRIDE_PKG_PROJECT]?(t[r.CA.EVENT_PKG_PROJECT]=e[r.CA.OVERRIDE_PKG_PROJECT],delete e[r.CA.OVERRIDE_PKG_PROJECT]):t[r.CA.EVENT_PKG_PROJECT]=this._config.ingestProject,t[r.CA.EVENT_PKG_TIME]=e[r.CA.EVENT_TIME_START]||(new Date).toISOString(),t[r.CA.EVENT_PKG_ENVIRONMENT]=this._config.envName,t[r.CA.EVENT_PKG_DATA]=e,t}_addPromiseToArrayIfDefined(e,t){void 0!==t&&e.push(t)}sendEventData(e,t=!0){const i={headers:this._getHeaders(),body:{events:[]}};for(const t of e)this._adornSDMEvent(t),this._redactTokens(t),i.body.events.push(this._wrapSDMData(t));if(0===i.body.events.length)return Promise.resolve();let s="";try{s=JSON.stringify(i.body)}catch(e){return Promise.reject(new l("JSON parsing an Ingest event body failed!",{retryable:!1}))}if(!1===this._appStartupHasCompleted){const e=[new Promise((e=>{setTimeout((()=>{e()}),this._appStartupCompleteTimeout)}))];return this._addPromiseToArrayIfDefined(e,this._windowOnloadPromise),this._addPromiseToArrayIfDefined(e,this._windowBeforeUnloadPromise),this._addPromiseToArrayIfDefined(e,this._windowVisibilityChangeHiddenPromise),Promise.race(e).then((()=>(this._appStartupHasCompleted=!0,this._sendRequest(s,i,t))))}return this._sendRequest(s,i,t)}_sendRequest(e,t,i=!0){const r=Date.now(),o=this._host.fetch(this._url.href,{method:"POST",keepalive:this._useKeepaliveForFetch,cache:s.eW.default,credentials:s.su.omit,headers:t.headers,redirect:s.A9.follow,referrerPolicy:s.xn.noReferrer,body:e}).catch((e=>{throw new l(`Network request failed: ${e}`,{network:!0})})).then((e=>{const t=Date.now()-r;if(this._ingestResponseCodesHistogram||(this._ingestResponseCodesHistogram=n.ZP.metrics.getMeter(`${this._config?.ingestProject}_ingest_responses`).createHistogram("hz_ingest_response_duration",{advice:{explicitBucketBoundaries:[250,500,1e3,5e3,1e4,15e3,2e4,25e3,3e4]}})),this._ingestResponseCodesHistogram.record(t,{status:e.status}),!e.ok)throw new l(`Network response was not ok: ${e.status}`,{network:!0})}));return i?(this._pendingRequests.add(o),o.then((()=>{this._pendingRequests.delete(o)}),(()=>{this._pendingRequests.delete(o)})),o):o}constructor(e,t){this._appStartupHasCompleted=!1,this._appStartupCompleteTimeout=3e3,this._useKeepaliveForFetch=!1,this._pendingRequests=new Set,this.sendEventData=this.sendEventData.bind(this),this._initPromise=Promise.all([t,e]).then((([e,t])=>{if(this._host=t,this._config=e,this._url=new URL("/ingest",this._config.ingestHost),!0===this._config.ingestWaitForAppStartup){if(this._host.executionEnvironment()!==s.st.Browser)return void(this._useKeepaliveForFetch=!0);this._windowBeforeUnloadPromise=new Promise((e=>{window.addEventListener("beforeunload",(()=>{this._useKeepaliveForFetch=!0,e()}))})),"hidden"===document.visibilityState&&(this._appStartupHasCompleted=!0,this._useKeepaliveForFetch=!0),this._setVisibilityChangePromise(),"complete"===document.readyState?this._appStartupHasCompleted=!0:this._windowOnloadPromise=new Promise((e=>{window.addEventListener("load",(()=>{e()}))}))}else this._appStartupHasCompleted=!0}))}}},825143:(e,t,i)=>{i.d(t,{$:()=>d});var s=i(616351),r=i(880990),o=i(126295),n=i(332805),a=i(696050);class d{static get defaultInstance(){if(d._defaultInstance)return d._defaultInstance;const e=n.y.singleton(),t=e.attach(a.q).then((()=>({useExperienceEdge:a.q.useExperienceEdge.isEnabled(),enableAEPAnalytics:a.q.enableAEPAnalytics.isEnabled(),aepConfigId:a.q.aepConfigId.value,launchURL:a.q.launchURL.value,marketingTechURL:a.q.marketingTechURL.value})));return d._defaultInstance=new d(e.getHost(),t),d._defaultInstance}static _resetInstance(){d._defaultInstance=void 0}async _initialized(){try{await this._initPromise;if(this._useExperienceEdge&&this._host.executionEnvironment()===s.st.Browser){window.alloy_load={data:{},...window.alloy_load},window.alloy_all={data:{_adobe_corpnew:{digitalData:{page:{pageInfo:{}}}}},...window.alloy_all};const e=this._config.launchURL,t=this._config.aepConfigId;window.marketingtech={adobe:{launch:{url:e,controlPageLoad:!0},alloy:{edgeConfigId:t},target:!1,audienceManager:!1,sophia:!1,marketingTags:{disableGlobalTags:!1,disableContentsquare:!0}}};try{const e=document.createElement("script");e.textContent='!function(){"use strict";var e=window,t=document,n=Object.defineProperty,a="replace",o=function(e){return e=e[a](/%2523access_token%253D.*?%2526/gim,"%2526")[a](/%23access_token%3D.*?%26/gim,"%26")[a](/#access_token=.*?&/gim,"&")[a](/information=[^&]+/,"")[a](/puser=[^&]+/,"")[a](/fnuser=[^&]+/,"")[a](/lnuser=[^&]+/,"")};function i(){try{var e="referrer",a=t[e],i=o(a);i!==a&&n(t,e,{configurable:!0,value:i})}catch(e){}}var r=t.head,l=e.marketingtech,c=decodeURIComponent;function d(e){var n,a,o,i;for(a=0,o=(n=t.cookie?t.cookie.split("; "):[]).length;a<o;a++)if(i=n[a],c(i.substr(0,i.indexOf("=")))===e)return c(i.substr(i.indexOf("=")+1))}function s(){var n,a,o,i="alloy-prehiding",c="@keyframes alloyShow{from {opacity: 0.01;} to {opacity: 1;}}body,.personalization-container{opacity:0.01 !important;animation: 0s 3s forwards alloyShow}",s=3e3;if(t.getElementById("feds-script")&&(i="manual-prehiding"),a=t.getElementById(i),o=function(e){try{e&&e.parentNode&&e.parentNode.removeChild(e)}catch(e){}},!(r&&l&&l.adobe&&l.adobe.target)||e.targetGlobalSettings&&!e.targetGlobalSettings.bodyHidingEnabled||-1!==e.location.href.indexOf("mboxEdit")||-1!==e.location.search.indexOf("mboxDisable=1")||-1!==e.location.search.indexOf("adobe_authoring_enabled")||-1!==t.cookie.indexOf("adobe_optout")||d("OptanonChoice")&&(n=d("OptanonConsent"))&&-1!==n.indexOf("C0002:0"))o(a);else{if(!a){(a=t.createElement("style")).id=i,a.innerHTML=c;try{r.appendChild(a)}catch(e){}}setTimeout((function(){o(a)}),s)}}const f="9E1005A551ED61CA0A490D45@AdobeOrg";function u(){e.alloy_getIdentity=new Promise((function(t){let n,a,o,i,r;if(n=new URLSearchParams(e.location.search).get("adobe_mc"))try{if(a=n.split("|").reduce(((e,t)=>{const[n,a]=t.split("=");return e[n]=a,e}),{}),o=parseInt(a.TS,10),i=a.MCMID,r=decodeURIComponent(a.MCORGID),i&&r===f&&Date.now()/1e3<=o+300)return t({edge:{},identity:{ECID:i}})}catch(e){}if(n=d("AMCV_"+f)){a=n.split("|");for(let e=0,n=a.length;e<n;e++){if("MCMID"===a[e])return t({edge:{},identity:{ECID:a[e+1]}})}}let l=function(){e.removeEventListener("alloy_sendEvent",l),e.alloy("getIdentity").then(t)};e.addEventListener("alloy_sendEvent",l)}))}function p(){return e.alloy_events=e.alloy_events||[]}var y=function(e,t){for(var n=t.split("."),a=e,o=0,i=n.length-1;o<i;o++){var r=n[o];if(!a[r])return;a=a[r]}return a[n[o]]},h=function(e,t,n){for(var a=t.split("."),o=e,i=0,r=a.length-1;i<r;i++){var l=a[i];o[l]=o[l]||{},o=o[l]}return o[a[i]]=n,e};function m(){var t=e.alloy_all=e.alloy_all||{};return t.promises=t.promises||[],t.xdm=t.xdm||{},t.data=t.data||{},t.get=function(e){return y(t,e)},t.set=function(e,n){return h(t,e,n)},t}var g=Promise;function _(){var t=e.alloy_load=e.alloy_load||{};return t.i=!1,t.sent=new g((function(e,n){t.r=e,t.j=n})),t.promises=t.promises||[],t.xdm=t.xdm||{},t.data=t.data||{},t.get=function(e){return y(t,e)},t.set=function(e,n){return h(t,e,n)},t}function v(){var t=e.alloy_unload=e.alloy_unload||{};return t.i=!1,t.sent=new g((function(e,n){t.r=e,t.j=n})),t.xdm=t.xdm||{},t.data=t.data||{},t.get=function(e){return y(t,e)},t.set=function(e,n){return h(t,e,n)},t}function b(){u(),p(),m(),_(),v()}function C(e){throw Error(e)}function x(e,n){var a=t.createElement("script"),o=!1;a.src=e,a.async=!0,n&&(a.onload=a.onreadystatechange=function(e){var t=this.readyState;o||t&&"complete"!==t&&"loaded"!==t||(o=!0,n(e))}),r?r.appendChild(a):t.body?t.body.appendChild(a):C("no script parent")}function k(){var t,n,a,o,i,r,c,d=[];t=function(t){o?t(e._satellite):d.push(t)},n=new g((function(e){t(e)})),e.__satelliteLoadedCallback=t,e.__satelliteLoadedPromise=n,a=function(){var t,n,a;for(o=!0,t=0,n=d.length;t<n;t++){a=d[t];try{a(e._satellite)}catch(e){}}},l&&(i=l.adobe)&&(r=i.launch)&&(c=r.url)&&x(c,a)}function D(){var t=[];e._satellite=e._satellite||{},e._satellite.track=function(e,n){(n=n||{})._beforeSatelliteLoaded=!0,t.push([e,n])},e.__satelliteLoadedCallback((function(){var n,a,o;for(n=0,a=t.length;n<a;n++)o=t[n],e._satellite.track(o[0],o[1])})),_satellite.track("pageView")}function E(){var t={_set:function(t,n){0!==t.indexOf("digitalData")&&(t="digitalData."+t),"object"!=typeof n&&"function"!=typeof n||!n.then||"function"!=typeof n.then||(n=n.unresolved||void 0),h(e.alloy_all,"data._adobe_corpnew."+t,n)}};e.digitalData=e.digitalData||t}-1===e.location.search.indexOf("marketingtech=off")&&(i(),s(),b(),k(),D(),E()),e.alloy_all&&e.alloy_all.set("data.marketingtech.bootstrap.version","0.28.1")}();',e.onerror=e=>{this._loadPromise?.reject(e),console.error("Failed to execute MarketingTech script",e)},document.head.appendChild(e),setTimeout((()=>{this._loadPromise?.resolve(),console.log("MarketingTech loaded successfully")}),100)}catch(e){this._loadPromise?.reject(e),console.error("Failed to create or execute MarketingTech script",e)}}else!this._loadPromise?.isSettled&&this._loadPromise?.resolve();this._isInitialized=!0}catch(e){!this._loadPromise?.isSettled&&this._loadPromise?.reject(e),console.error("Failed to initialized marketingTech",e)}return this._loadPromise?.promise}_generatePayload(e){return{eventType:"web.webinteraction.linkClicks",xdm:{web:{webPageDetails:{isErrorPage:!1,isHomePage:!1,name:window.location.host,server:window.location.href,siteSection:window.location.href},webReferrer:{URL:e[r.CA.EVENT_REFERRER]||""},webInteraction:{name:e[r.CA.EVENT_PAGENAME]||"",linkClicks:{value:1},type:"other"}}},data:{_adobe_corpnew:{digitalData:{},sdm:this._unflatten(e)},marketingtech:{adobe:{alloy:{approach:"optimized",edgeConfigId:this._config.aepConfigId}}}}}}_setProp(e,t,i){const s=t.indexOf("."),r=t.substring(0,s),o=t.substring(s+1);e[r]=e[r]||{};const n=e[r];o.includes(".")?this._setProp(n,o,i):n[o]=i}_unflatten(e){const t={};for(const i of Object.keys(e))i!==r.CA.APP_CONFIG_OVERRIDES&&(i.includes(".")?this._setProp(t,i,e[i]):t[i]=e[i]);return t}_sendEvent(e){try{if(!this._useExperienceEdge||!this._enableAEPAnalytics)return;window._satellite.track("event",e)}catch(e){console.warn("MarketingTechService encountered an unexpected error sending events to AEP",e)}}sendEvent(e){const t=this._generatePayload(e);this._isInitialized?this._sendEvent(t):this._initialized().then((()=>{this._sendEvent(t)}))}async mcidGuid(){if(this._isInitialized||await this._initialized(),!this._useExperienceEdge)return"";try{return(await window.alloy_getIdentity).identity?.ECID??r.J6}catch(e){return console.warn("Could not get ECID. Mostly adBlocker is blocking calls to AEP",e),r.J6}}trackProposition(e,t){const i=()=>{"undefined"!=typeof window&&window._satellite&&window._satellite?.track(e,t)};this._isInitialized?i():this._initialized().then(i)}constructor(e,t){this.sendEvent=this.sendEvent.bind(this),this.mcidGuid=this.mcidGuid.bind(this),this._isInitialized=!1,this._useExperienceEdge=!1,this._enableAEPAnalytics=!1,this._loadPromise=new o.B,this._initPromise=Promise.all([e,t,t.then((e=>e.useExperienceEdge)),t.then((e=>e.enableAEPAnalytics))]).then((([e,t,i,s])=>{this._host=e,this._config=t,this._useExperienceEdge=i,this._enableAEPAnalytics=s}))}}},812683:(e,t,i)=>{i.d(t,{W:()=>s});class s{}s.UI="ui",s.AUTHORING="authoring",s.RENDERING="rendering",s.DEFAULT="default"},126295:(e,t,i)=>{i.d(t,{B:()=>r});var s=i(334398);class r{get promise(){return this._promiseInUse=!0,this._promise}get isSettled(){return this._isFulfilled||this._isRejected}get isFulfilled(){return this._isFulfilled}get isRejected(){return this._isRejected}adopt(e){return this._promiseInUse=!0,e.then(this._resolvePromise).catch(this._rejectPromise),this.promise}adoptOnce(e){return this._promiseInUse=!0,this._hasAdoptedOnce||(this.adopt(e()),this._hasAdoptedOnce=!0),this.promise}resolve(e){this._resolvePromise(e)}reject(e){this._rejectPromise(e)}reset(){!this._isFulfilled&&!this._isRejected&&this._promiseInUse&&this._rejectPromise&&this._rejectPromise(new s.R("DeferredPromiseReset","Deferred was reset before result arrived")),this._isFulfilled=!1,this._isRejected=!1,this._hasAdoptedOnce=!1,this._promiseInUse=!1,this._promise=new Promise(((e,t)=>{this._resolvePromise=t=>{this._isFulfilled=!0,this._isRejected=!1,e(t)},this._rejectPromise=e=>{this._isRejected=!0,this._isFulfilled=!1,t(e)}}))}constructor(){this._isFulfilled=!1,this._isRejected=!1,this._hasAdoptedOnce=!1,this._promiseInUse=!1,this.reset()}}},334398:(e,t,i)=>{i.d(t,{R:()=>n});var s=i(689858),r=i(799249),o=i(413209);Error.stackTraceLimit=50;class n extends Error{get code(){return this._code}get uuid(){return this._uuid||(this._uuid=(0,s.Z)()),this._uuid}set uuid(e){this._uuid=e}get isExpected(){return!!this._isExpected||this.previousError instanceof n&&this.previousError.isExpected}set isExpected(e){this._isExpected=e}hasErrorCode(e){return this.code===e||this.previousError instanceof n&&this.previousError.hasErrorCode(e)}findErrorBy(e){return e(this)?this:this.previousError instanceof n?this.previousError.findErrorBy(e):void 0}getDataRepresentation(e={skipStack:!1}){const t={kind:"HzError",code:this.code,message:this.message,stack:e.skipStack?void 0:this.stack,uuid:this.uuid,category:this.category,isExpected:this.isExpected,logMetadata:this.logMetadata};return this.previousError&&(this.previousError instanceof n?t.previousErrorData=this.previousError.getDataRepresentation(e):t.previousErrorData={kind:"Error",name:this.previousError.name,message:this.previousError.message,stack:e.skipStack?void 0:this.previousError.stack}),(0,r.a1)(t)}_getErrorMessageWithCode(e){return(0,o.isAdobeDCXError)(e)?`${e.name}: ${e.code}: ${e.message}`:`${e.name}: ${e.message}`}_getDCXUnderlyingErrorMessage(e){let t=this._getErrorMessageWithCode(e);return(0,o.isAdobeDCXError)(e)&&e.underlyingError&&(t+=`\nFrom underlying error: ${this._getDCXUnderlyingErrorMessage(e.underlyingError)}`),t}_getDCXErrorFullStack(e){let t=e.stack;return(0,o.isAdobeDCXError)(e)&&e.underlyingError&&(t+=`\nFrom underlying error: ${this._getDCXErrorFullStack(e.underlyingError)}`),t}get fullStack(){let e=this.stack||"";return this.previousError&&(e+="\nFrom previous error: ",this.previousError instanceof n?e+=this.previousError.fullStack:(0,o.isAdobeDCXError)(this.previousError)?e+=this._getDCXErrorFullStack(this.previousError):e+=this.previousError.stack),e.replace(/access_token=[0-9A-Za-z-._%=]+/,"")}get messageWithCode(){return this.category?`${this.category}: ${this.code}: ${this.message}`:`${this.code}: ${this.message}`}get fullMessageWithCode(){let e=this.messageWithCode;return this.previousError&&(e+="\nFrom previous error: ",this.previousError instanceof n?e+=this.previousError.fullMessageWithCode:(0,o.isAdobeDCXError)(this.previousError)?e+=this._getDCXUnderlyingErrorMessage(this.previousError):e+=this.previousError),e}get fullLogMetadata(){let e=this.logMetadata;if(this.previousError instanceof n){const t=this.previousError.fullLogMetadata;t&&(e=Object.assign({},this.logMetadata),e.previousLogMetadata=t)}return e}constructor(e,t,i){super(t),this._code=e,this._isExpected=!1,this.name=e+"Error",i&&(i instanceof Error?this.previousError=i:(this.previousError=i.previousError,this.category=i.category,this.logMetadata=i.logMetadata,this.isExpected=Boolean(i.isExpected)))}}},799249:(e,t,i)=>{i.d(t,{a1:()=>r,or:()=>o});const s=["authorization","authtoken","servicetoken"];function r(e){if(!e)return e;try{const t=o(e);return t?JSON.parse(t):{}}catch(e){return console.error("safeCopy() - Failed to copy",e),{}}}function o(e){try{const t=new Set;return JSON.stringify(e,((e,i)=>{if("string"==typeof e&&s.includes(e.toLowerCase()))return"xxxxx";if(null!==i){if(i instanceof Date)return i.toISOString();const e=typeof i;if("object"===e||i instanceof Array){if(t.has(i))return"--visited--";t.add(i)}else{if("bigint"===e)return i.toString();if("number"===e&&!Number.isFinite(i))return i.toString()}}return i}))}catch(e){return console.error("safeStringify() - Failed to stringify",e),""}}}}]);
//# sourceMappingURL=12704.35eb93c0850f7c035333.js.map